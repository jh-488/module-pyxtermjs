<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Python Terminal-Server</title><meta name="description" content="This is a terminal-server based on <a href='https://github.com/cs01/pyxtermjs' target='_blank'>pyxtermjs</a>. A server should be started locally and shared in station mode. For more information and configuration options, see <br><a href='https://github.com/Cross-Lab-Project/edrys_module-pyxtermjs' target='_blank'>Cross-Lab-Project/edrys_module-pyxtermjs</a>"><style>html{font-family:arial}</style><link rel="stylesheet" href="https://unpkg.com/xterm@4.11.0/css/xterm.css"><meta name="show-in" content="station"><script type="module" src="index.7f78c2cb.js"></script><script defer src="https://edrys-labs.github.io/module/vendor/alpine.min.js"></script><link rel="stylesheet" href="https://edrys-labs.github.io/module/vendor/water.min.css"><link rel="stylesheet" href="https://edrys-labs.github.io/module/vendor/open-iconic/css/open-iconic.min.css"><script src="https://edrys-labs.github.io/module/edrys.js"></script><script src="https://unpkg.com/vue@3"></script></head><body style="max-width:100%;margin-bottom:0;padding-left:0"> <div id="app"> <span style="margin-left:2rem;font-size:small"> status: <span v-if="status === false" style="background-color:#ff8383">disconnected</span> <span v-if="status === null">connecting ...</span> <span v-if="status === true" style="background-color:#90ee90">connected</span> </span> <span style="float:right;align-items:center;font-size:small;display:flex" v-if="isStation"> <label> student: <input type="checkbox" v-model="enable.student"> </label> <label> teacher: <input type="checkbox" v-model="enable.teacher"> </label> <input type="input" style="display:inline-flex" v-model="server"> <button style="margin-right:0;display:inline-flex" @click="reload()"> reload </button> </span> <textarea style="height:4.25rem" v-model="script" v-if="isStation">
        {{script}}
      </textarea> </div> <div style="width:calc(100% + 10px)" id="terminal"></div>  <script src="index.302fc86c.js"></script> <script src="index.a8d293b9.js"></script> <script src="index.cc94d01e.js"></script> <script src="index.09b6c50e.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.min.js"></script>  <script type="module" src="index.2bb9dcfc.js"></script> <script type="module">let e,t,i;var r=globalThis,n={},s={},a=r.parcelRequiref158;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in s){var t=s[e];delete s[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){s[e]=t},r.parcelRequiref158=a),a.register,a("kjyEk");var o=a("hPtJY"),l=a("6ZWSX").Buffer;function h(e,t,i,r){return new(i||(i=Promise))(function(n,s){function a(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})}function d(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise(function(r,n){!function(e,t,i,r){Promise.resolve(r).then(function(t){e({value:t,done:i})},t)}(r,n,(t=e[i](t)).done,t.value)})}}}function u(e){let t=e.length;for(;--t>=0;)e[t]=0}"function"==typeof SuppressedError&&SuppressedError;const f=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),c=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),_=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),p=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),w=Array(576);u(w);const m=Array(60);u(m);const g=Array(512);u(g);const y=Array(256);u(y);const b=Array(29);u(b);const v=Array(30);function k(e,t,i,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function x(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}u(v);const A=e=>e<256?g[e]:g[256+(e>>>7)],z=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},S=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,z(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},T=(e,t,i)=>{S(e,i[2*t],i[2*t+1])},E=(e,t)=>{let i=0;do i|=1&e,e>>>=1,i<<=1;while(--t>0)return i>>>1},F=(e,t,i)=>{let r=Array(16),n,s,a=0;for(n=1;n<=15;n++)a=a+i[n-1]<<1,r[n]=a;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=E(r[t]++,t))}},I=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},C=e=>{e.bi_valid>8?z(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},B=(e,t,i,r)=>{let n=2*t,s=2*i;return e[n]<e[s]||e[n]===e[s]&&r[t]<=r[i]},R=(e,t,i)=>{let r=e.heap[i],n=i<<1;for(;n<=e.heap_len&&(n<e.heap_len&&B(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!B(t,r,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=r},D=(e,t,i)=>{let r,n,s,a,o=0;if(0!==e.sym_next)do r=(255&e.pending_buf[e.sym_buf+o++])+((255&e.pending_buf[e.sym_buf+o++])<<8),n=e.pending_buf[e.sym_buf+o++],0===r?T(e,n,t):(T(e,(s=y[n])+256+1,t),0!==(a=f[s])&&S(e,n-=b[s],a),T(e,s=A(--r),i),0!==(a=c[s])&&S(e,r-=v[s],a));while(o<e.sym_next)T(e,256,t)},U=(e,t)=>{let i=t.dyn_tree,r=t.stat_desc.static_tree,n=t.stat_desc.has_stree,s=t.stat_desc.elems,a,o,l,h=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<s;a++)0!==i[2*a]?(e.heap[++e.heap_len]=h=a,e.depth[a]=0):i[2*a+1]=0;for(;e.heap_len<2;)i[2*(l=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[l]=0,e.opt_len--,n&&(e.static_len-=r[2*l+1]);for(t.max_code=h,a=e.heap_len>>1;a>=1;a--)R(e,i,a);l=s;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],R(e,i,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,i[2*l]=i[2*a]+i[2*o],e.depth[l]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,i[2*a+1]=i[2*o+1]=l,e.heap[1]=l++,R(e,i,1);while(e.heap_len>=2)e.heap[--e.heap_max]=e.heap[1],((e,t)=>{let i=t.dyn_tree,r=t.max_code,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length,h,d,u,f,c,_,p=0;for(f=0;f<=15;f++)e.bl_count[f]=0;for(i[2*e.heap[e.heap_max]+1]=0,h=e.heap_max+1;h<573;h++)(f=i[2*i[2*(d=e.heap[h])+1]+1]+1)>l&&(f=l,p++),i[2*d+1]=f,d>r||(e.bl_count[f]++,c=0,d>=o&&(c=a[d-o]),_=i[2*d],e.opt_len+=_*(f+c),s&&(e.static_len+=_*(n[2*d+1]+c)));if(0!==p){do{for(f=l-1;0===e.bl_count[f];)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[l]--,p-=2}while(p>0)for(f=l;0!==f;f--)for(d=e.bl_count[f];0!==d;)(u=e.heap[--h])>r||(i[2*u+1]!==f&&(e.opt_len+=(f-i[2*u+1])*i[2*u],i[2*u+1]=f),d--)}})(e,t),F(i,h,e.bl_count)},N=(e,t,i)=>{let r,n,s=-1,a=t[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),t[2*(i+1)+1]=65535,r=0;r<=i;r++)n=a,a=t[2*(r+1)+1],++o<l&&n===a||(o<h?e.bl_tree[2*n]+=o:0!==n?(n!==s&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=n,0===a?(l=138,h=3):n===a?(l=6,h=3):(l=7,h=4))},L=(e,t,i)=>{let r,n,s=-1,a=t[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),r=0;r<=i;r++)if(n=a,a=t[2*(r+1)+1],!(++o<l&&n===a)){if(o<h)do T(e,n,e.bl_tree);while(0!=--o)else 0!==n?(n!==s&&(T(e,n,e.bl_tree),o--),T(e,16,e.bl_tree),S(e,o-3,2)):o<=10?(T(e,17,e.bl_tree),S(e,o-3,3)):(T(e,18,e.bl_tree),S(e,o-11,7));o=0,s=n,0===a?(l=138,h=3):n===a?(l=6,h=3):(l=7,h=4)}};let O=!1;const P=(e,t,i,r)=>{S(e,0+(r?1:0),3),C(e),z(e,i),z(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i};var M={_tr_init:r=>{O||((()=>{let r,n,s,a,o;let l=Array(16);for(s=0,a=0;a<28;a++)for(b[a]=s,r=0;r<1<<f[a];r++)y[s++]=a;for(y[s-1]=a,o=0,a=0;a<16;a++)for(v[a]=o,r=0;r<1<<c[a];r++)g[o++]=a;for(o>>=7;a<30;a++)for(v[a]=o<<7,r=0;r<1<<c[a]-7;r++)g[256+o++]=a;for(n=0;n<=15;n++)l[n]=0;for(r=0;r<=143;)w[2*r+1]=8,r++,l[8]++;for(;r<=255;)w[2*r+1]=9,r++,l[9]++;for(;r<=279;)w[2*r+1]=7,r++,l[7]++;for(;r<=287;)w[2*r+1]=8,r++,l[8]++;for(F(w,287,l),r=0;r<30;r++)m[2*r+1]=5,m[2*r]=E(r,5);e=new k(w,f,257,286,15),t=new k(m,c,0,30,15),i=new k([],_,0,19,7)})(),O=!0),r.l_desc=new x(r.dyn_ltree,e),r.d_desc=new x(r.dyn_dtree,t),r.bl_desc=new x(r.bl_tree,i),r.bi_buf=0,r.bi_valid=0,I(r)},_tr_stored_block:P,_tr_flush_block:(e,t,i,r)=>{let n,s,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),U(e,e.l_desc),U(e,e.d_desc),a=(e=>{let t;for(N(e,e.dyn_ltree,e.l_desc.max_code),N(e,e.dyn_dtree,e.d_desc.max_code),U(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*p[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),n=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=n&&(n=s)):n=s=i+5,i+4<=n&&-1!==t?P(e,t,i,r):4===e.strategy||s===n?(S(e,2+(r?1:0),3),D(e,w,m)):(S(e,4+(r?1:0),3),((e,t,i,r)=>{let n;for(S(e,t-257,5),S(e,i-1,5),S(e,r-4,4),n=0;n<r;n++)S(e,e.bl_tree[2*p[n]+1],3);L(e,e.dyn_ltree,t-1),L(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),D(e,e.dyn_ltree,e.dyn_dtree)),I(e),r&&C(e)},_tr_tally:(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(y[i]+256+1)]++,e.dyn_dtree[2*A(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{S(e,2,3),T(e,256,w),16===e.bi_valid?(z(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},Z=(e,t,i,r)=>{let n=65535&e|0,s=e>>>16&65535|0,a=0;for(;0!==i;){a=i>2e3?2e3:i,i-=a;do s=s+(n=n+t[r++]|0)|0;while(--a)n%=65521,s%=65521}return n|s<<16|0};const $=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());var j=(e,t,i,r)=>{let n=r+i;e^=-1;for(let i=r;i<n;i++)e=e>>>8^$[255&(e^t[i])];return -1^e},H={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},W={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:q,_tr_stored_block:J,_tr_flush_block:K,_tr_tally:Y,_tr_align:G}=M,{Z_NO_FLUSH:X,Z_PARTIAL_FLUSH:V,Z_FULL_FLUSH:Q,Z_FINISH:ee,Z_BLOCK:et,Z_OK:ei,Z_STREAM_END:er,Z_STREAM_ERROR:en,Z_DATA_ERROR:es,Z_BUF_ERROR:ea,Z_DEFAULT_COMPRESSION:eo,Z_FILTERED:el,Z_HUFFMAN_ONLY:eh,Z_RLE:ed,Z_FIXED:eu,Z_DEFAULT_STRATEGY:ef,Z_UNKNOWN:ec,Z_DEFLATED:e_}=W,ep=(e,t)=>(e.msg=H[t],t),ew=e=>2*e-(e>4?9:0),em=e=>{let t=e.length;for(;--t>=0;)e[t]=0},eg=e=>{let t,i,r,n=e.w_size;r=t=e.hash_size;do i=e.head[--r],e.head[r]=i>=n?i-n:0;while(--t)r=t=n;do i=e.prev[--r],e.prev[r]=i>=n?i-n:0;while(--t)};let ey=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const eb=e=>{let t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},ev=(e,t)=>{K(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,eb(e.strm)},ek=(e,t)=>{e.pending_buf[e.pending++]=t},ex=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},eA=(e,t,i,r)=>{let n=e.avail_in;return n>r&&(n=r),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),i),1===e.state.wrap?e.adler=Z(e.adler,t,n,i):2===e.state.wrap&&(e.adler=j(e.adler,t,n,i)),e.next_in+=n,e.total_in+=n,n)},ez=(e,t)=>{let i,r,n=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,h=e.window,d=e.w_mask,u=e.prev,f=e.strstart+258,c=h[s+a-1],_=h[s+a];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do if(h[(i=t)+a]===_&&h[i+a-1]===c&&h[i]===h[s]&&h[++i]===h[s+1]){s+=2,i++;do;while(h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&s<f)if(r=258-(f-s),s=f-258,r>a){if(e.match_start=t,a=r,r>=o)break;c=h[s+a-1],_=h[s+a]}}while((t=u[t&d])>l&&0!=--n)return a<=e.lookahead?a:e.lookahead},eS=e=>{let t,i,r;let n=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-262)&&(e.window.set(e.window.subarray(n,n+n-i),0),e.match_start-=n,e.strstart-=n,e.block_start-=n,e.insert>e.strstart&&(e.insert=e.strstart),eg(e),i+=n),0===e.strm.avail_in)break;if(t=eA(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=t,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=ey(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=ey(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},eT=(e,t)=>{let i,r,n,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,o=e.strm.avail_in;do{if(i=65535,n=e.bi_valid+42>>3,e.strm.avail_out<n||(n=e.strm.avail_out-n,i>(r=e.strstart-e.block_start)+e.strm.avail_in&&(i=r+e.strm.avail_in),i>n&&(i=n),i<s&&(0===i&&t!==ee||t===X||i!==r+e.strm.avail_in)))break;a=t===ee&&i===r+e.strm.avail_in?1:0,J(e,0,0,a),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,eb(e.strm),r&&(r>i&&(r=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,i-=r),i&&(eA(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===a)return(o-=e.strm.avail_in)&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==X&&t!==ee&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(n=e.window_size-e.strstart,e.strm.avail_in>n&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,n+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),n>e.strm.avail_in&&(n=e.strm.avail_in),n&&(eA(e.strm,e.window,e.strstart,n),e.strstart+=n,e.insert+=n>e.w_size-e.insert?e.w_size-e.insert:n),e.high_water<e.strstart&&(e.high_water=e.strstart),n=e.bi_valid+42>>3,s=(n=e.pending_buf_size-n>65535?65535:e.pending_buf_size-n)>e.w_size?e.w_size:n,((r=e.strstart-e.block_start)>=s||(r||t===ee)&&t!==X&&0===e.strm.avail_in&&r<=n)&&(i=r>n?n:r,a=t===ee&&0===e.strm.avail_in&&i===r?1:0,J(e,e.block_start,i,a),e.block_start+=i,eb(e.strm)),a?3:1)},eE=(e,t)=>{let i,r;for(;;){if(e.lookahead<262){if(eS(e),e.lookahead<262&&t===X)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=ey(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-262&&(e.match_length=ez(e,i)),e.match_length>=3){if(r=Y(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=ey(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length)e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=ey(e,e.ins_h,e.window[e.strstart+1])}else r=Y(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(ev(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ee?(ev(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(ev(e,!1),0===e.strm.avail_out)?1:2},eF=(e,t)=>{let i,r,n;for(;;){if(e.lookahead<262){if(eS(e),e.lookahead<262&&t===X)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=ey(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-262&&(e.match_length=ez(e,i),e.match_length<=5&&(e.strategy===el||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,r=Y(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=ey(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length)if(e.match_available=0,e.match_length=2,e.strstart++,r&&(ev(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=Y(e,0,e.window[e.strstart-1]))&&ev(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Y(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ee?(ev(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(ev(e,!1),0===e.strm.avail_out)?1:2};function eI(e,t,i,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=n}const eC=[new eI(0,0,0,0,eT),new eI(4,4,8,4,eE),new eI(4,5,16,8,eE),new eI(4,6,32,32,eE),new eI(4,4,16,16,eF),new eI(8,16,32,32,eF),new eI(8,16,128,128,eF),new eI(8,32,128,256,eF),new eI(32,128,258,1024,eF),new eI(32,258,258,4096,eF)];function eB(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=e_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),em(this.dyn_ltree),em(this.dyn_dtree),em(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),em(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),em(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const eR=e=>{if(!e)return 1;let t=e.state;return t&&t.strm===e&&(42===t.status||57===t.status||69===t.status||73===t.status||91===t.status||103===t.status||113===t.status||666===t.status)?0:1},eD=e=>{if(eR(e))return ep(e,en);e.total_in=e.total_out=0,e.data_type=ec;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=-2,q(t),ei},eU=e=>{var t;let i=eD(e);return i===ei&&((t=e.state).window_size=2*t.w_size,em(t.head),t.max_lazy_match=eC[t.level].max_lazy,t.good_match=eC[t.level].good_length,t.nice_match=eC[t.level].nice_length,t.max_chain_length=eC[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),i},eN=(e,t,i,r,n,s)=>{if(!e)return en;let a=1;if(t===eo&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),n<1||n>9||i!==e_||r<8||r>15||t<0||t>9||s<0||s>eu||8===r&&1!==a)return ep(e,en);8===r&&(r=9);let o=new eB;return e.state=o,o.strm=e,o.status=42,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=s,o.method=i,eU(e)};var eL={deflateInit:(e,t)=>eN(e,t,e_,15,8,ef),deflateInit2:eN,deflateReset:eU,deflateResetKeep:eD,deflateSetHeader:(e,t)=>eR(e)||2!==e.state.wrap?en:(e.state.gzhead=t,ei),deflate:(e,t)=>{if(eR(e)||t>et||t<0)return e?ep(e,en):en;let i=e.state;if(!e.output||0!==e.avail_in&&!e.input||666===i.status&&t!==ee)return ep(e,0===e.avail_out?ea:en);let r=i.last_flush;if(i.last_flush=t,0!==i.pending){if(eb(e),0===e.avail_out)return i.last_flush=-1,ei}else if(0===e.avail_in&&ew(t)<=ew(r)&&t!==ee)return ep(e,ea);if(666===i.status&&0!==e.avail_in)return ep(e,ea);if(42===i.status&&0===i.wrap&&(i.status=113),42===i.status){let t=e_+(i.w_bits-8<<4)<<8;if(t|=(i.strategy>=eh||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(t|=32),ex(i,t+=31-t%31),0!==i.strstart&&(ex(i,e.adler>>>16),ex(i,65535&e.adler)),e.adler=1,i.status=113,eb(e),0!==i.pending)return i.last_flush=-1,ei}if(57===i.status){if(e.adler=0,ek(i,31),ek(i,139),ek(i,8),i.gzhead)ek(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ek(i,255&i.gzhead.time),ek(i,i.gzhead.time>>8&255),ek(i,i.gzhead.time>>16&255),ek(i,i.gzhead.time>>24&255),ek(i,9===i.level?2:i.strategy>=eh||i.level<2?4:0),ek(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(ek(i,255&i.gzhead.extra.length),ek(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=j(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(ek(i,0),ek(i,0),ek(i,0),ek(i,0),ek(i,0),ek(i,9===i.level?2:i.strategy>=eh||i.level<2?4:0),ek(i,3),i.status=113,eb(e),0!==i.pending)return i.last_flush=-1,ei}if(69===i.status){if(i.gzhead.extra){let t=i.pending,r=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+r>i.pending_buf_size;){let n=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=j(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=n,eb(e),0!==i.pending)return i.last_flush=-1,ei;t=0,r-=n}let n=new Uint8Array(i.gzhead.extra);i.pending_buf.set(n.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending+=r,i.gzhead.hcrc&&i.pending>t&&(e.adler=j(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let t,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(e.adler=j(e.adler,i.pending_buf,i.pending-r,r)),eb(e),0!==i.pending)return i.last_flush=-1,ei;r=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,ek(i,t)}while(0!==t)i.gzhead.hcrc&&i.pending>r&&(e.adler=j(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let t,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(e.adler=j(e.adler,i.pending_buf,i.pending-r,r)),eb(e),0!==i.pending)return i.last_flush=-1,ei;r=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,ek(i,t)}while(0!==t)i.gzhead.hcrc&&i.pending>r&&(e.adler=j(e.adler,i.pending_buf,i.pending-r,r))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(eb(e),0!==i.pending))return i.last_flush=-1,ei;ek(i,255&e.adler),ek(i,e.adler>>8&255),e.adler=0}if(i.status=113,eb(e),0!==i.pending)return i.last_flush=-1,ei}if(0!==e.avail_in||0!==i.lookahead||t!==X&&666!==i.status){let r=0===i.level?eT(i,t):i.strategy===eh?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(eS(e),0===e.lookahead)){if(t===X)return 1;break}if(e.match_length=0,i=Y(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(ev(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ee?(ev(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(ev(e,!1),0===e.strm.avail_out)?1:2})(i,t):i.strategy===ed?((e,t)=>{let i,r,n,s;let a=e.window;for(;;){if(e.lookahead<=258){if(eS(e),e.lookahead<=258&&t===X)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=a[n=e.strstart-1])===a[++n]&&r===a[++n]&&r===a[++n]){s=e.strstart+258;do;while(r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&n<s)e.match_length=258-(s-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=Y(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=Y(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(ev(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ee?(ev(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(ev(e,!1),0===e.strm.avail_out)?1:2})(i,t):eC[i.level].func(i,t);if(3!==r&&4!==r||(i.status=666),1===r||3===r)return 0===e.avail_out&&(i.last_flush=-1),ei;if(2===r&&(t===V?G(i):t!==et&&(J(i,0,0,!1),t===Q&&(em(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),eb(e),0===e.avail_out))return i.last_flush=-1,ei}return t!==ee?ei:i.wrap<=0?er:(2===i.wrap?(ek(i,255&e.adler),ek(i,e.adler>>8&255),ek(i,e.adler>>16&255),ek(i,e.adler>>24&255),ek(i,255&e.total_in),ek(i,e.total_in>>8&255),ek(i,e.total_in>>16&255),ek(i,e.total_in>>24&255)):(ex(i,e.adler>>>16),ex(i,65535&e.adler)),eb(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?ei:er)},deflateEnd:e=>{if(eR(e))return en;let t=e.state.status;return e.state=null,113===t?ep(e,es):ei},deflateSetDictionary:(e,t)=>{let i=t.length;if(eR(e))return en;let r=e.state,n=r.wrap;if(2===n||1===n&&42!==r.status||r.lookahead)return en;if(1===n&&(e.adler=Z(e.adler,t,i,0)),r.wrap=0,i>=r.w_size){0===n&&(em(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(i-r.w_size,i),0),t=e,i=r.w_size}let s=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,eS(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do r.ins_h=ey(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++;while(--t)r.strstart=e,r.lookahead=2,eS(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=o,e.avail_in=s,r.wrap=n,ei},deflateInfo:"pako deflate (from Nodeca project)"};const eO=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var eP={assign:function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let i=t.shift();if(i){if("object"!=typeof i)throw TypeError(i+"must be non-object");for(let t in i)eO(i,t)&&(e[t]=i[t])}}return e},flattenChunks:e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;let i=new Uint8Array(t);for(let t=0,r=0,n=e.length;t<n;t++){let n=e[t];i.set(n,r),r+=n.length}return i}};let eM=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){eM=!1}const eZ=new Uint8Array(256);for(let e=0;e<256;e++)eZ[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;eZ[254]=eZ[254]=1;var e$={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,r,n,s,a=e.length,o=0;for(n=0;n<a;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(r-56320),n++),o+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(o),s=0,n=0;s<o;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(r-56320),n++),i<128?t[s++]=i:(i<2048?t[s++]=192|i>>>6:(i<65536?t[s++]=224|i>>>12:(t[s++]=240|i>>>18,t[s++]=128|i>>>12&63),t[s++]=128|i>>>6&63),t[s++]=128|63&i);return t},buf2string:(e,t)=>{let i,r;let n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let s=Array(2*n);for(r=0,i=0;i<n;){let t=e[i++];if(t<128){s[r++]=t;continue}let a=eZ[t];if(a>4)s[r++]=65533,i+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&i<n;)t=t<<6|63&e[i++],a--;a>1?s[r++]=65533:t<65536?s[r++]=t:(t-=65536,s[r++]=55296|t>>10&1023,s[r++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&eM)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let r=0;r<t;r++)i+=String.fromCharCode(e[r]);return i})(s,r)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+eZ[e[i]]>t?i:t}},ej=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const eH=Object.prototype.toString,{Z_NO_FLUSH:eW,Z_SYNC_FLUSH:eq,Z_FULL_FLUSH:eJ,Z_FINISH:eK,Z_OK:eY,Z_STREAM_END:eG,Z_DEFAULT_COMPRESSION:eX,Z_DEFAULT_STRATEGY:eV,Z_DEFLATED:eQ}=W;function e0(e){this.options=eP.assign({level:eX,method:eQ,chunkSize:16384,windowBits:15,memLevel:8,strategy:eV},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ej,this.strm.avail_out=0;let i=eL.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==eY)throw Error(H[i]);if(t.header&&eL.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?e$.string2buf(t.dictionary):"[object ArrayBuffer]"===eH.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=eL.deflateSetDictionary(this.strm,e))!==eY)throw Error(H[i]);this._dict_set=!0}}function e1(e,t){let i=new e0(t);if(i.push(e,!0),i.err)throw i.msg||H[i.err];return i.result}e0.prototype.push=function(e,t){let i,r;let n=this.strm,s=this.options.chunkSize;if(this.ended)return!1;for(r=t===~~t?t:!0===t?eK:eW,"string"==typeof e?n.input=e$.string2buf(e):"[object ArrayBuffer]"===eH.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(s),n.next_out=0,n.avail_out=s),(r===eq||r===eJ)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if((i=eL.deflate(n,r))===eG)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=eL.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===eY;if(0!==n.avail_out){if(r>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},e0.prototype.onData=function(e){this.chunks.push(e)},e0.prototype.onEnd=function(e){e===eY&&(this.result=eP.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var e2=function(e,t){let i,r,n,s,a,o,l,h,d,u,f,c,_,p,w,m,g,y,b,v,k,x,A,z;let S=e.state;i=e.next_in,A=e.input,r=i+(e.avail_in-5),n=e.next_out,z=e.output,s=n-(t-e.avail_out),a=n+(e.avail_out-257),o=S.dmax,l=S.wsize,h=S.whave,d=S.wnext,u=S.window,f=S.hold,c=S.bits,_=S.lencode,p=S.distcode,w=(1<<S.lenbits)-1,m=(1<<S.distbits)-1;e:do for(c<15&&(f+=A[i++]<<c,c+=8,f+=A[i++]<<c,c+=8),g=_[f&w];;){if(f>>>=y=g>>>24,c-=y,0==(y=g>>>16&255))z[n++]=65535&g;else{if(!(16&y)){if(0==(64&y)){g=_[(65535&g)+(f&(1<<y)-1)];continue}if(32&y){S.mode=16191;break e}e.msg="invalid literal/length code",S.mode=16209;break e}for(b=65535&g,(y&=15)&&(c<y&&(f+=A[i++]<<c,c+=8),b+=f&(1<<y)-1,f>>>=y,c-=y),c<15&&(f+=A[i++]<<c,c+=8,f+=A[i++]<<c,c+=8),g=p[f&m];;){if(f>>>=y=g>>>24,c-=y,!(16&(y=g>>>16&255))){if(0==(64&y)){g=p[(65535&g)+(f&(1<<y)-1)];continue}e.msg="invalid distance code",S.mode=16209;break e}if(v=65535&g,c<(y&=15)&&(f+=A[i++]<<c,(c+=8)<y&&(f+=A[i++]<<c,c+=8)),(v+=f&(1<<y)-1)>o){e.msg="invalid distance too far back",S.mode=16209;break e}if(f>>>=y,c-=y,v>(y=n-s)){if((y=v-y)>h&&S.sane){e.msg="invalid distance too far back",S.mode=16209;break e}if(k=0,x=u,0===d){if(k+=l-y,y<b){b-=y;do z[n++]=u[k++];while(--y)k=n-v,x=z}}else if(d<y){if(k+=l+d-y,(y-=d)<b){b-=y;do z[n++]=u[k++];while(--y)if(k=0,d<b){b-=y=d;do z[n++]=u[k++];while(--y)k=n-v,x=z}}}else if(k+=d-y,y<b){b-=y;do z[n++]=u[k++];while(--y)k=n-v,x=z}for(;b>2;)z[n++]=x[k++],z[n++]=x[k++],z[n++]=x[k++],b-=3;b&&(z[n++]=x[k++],b>1&&(z[n++]=x[k++]))}else{k=n-v;do z[n++]=z[k++],z[n++]=z[k++],z[n++]=z[k++],b-=3;while(b>2)b&&(z[n++]=z[k++],b>1&&(z[n++]=z[k++]))}break}}break}while(i<r&&n<a)i-=b=c>>3,c-=b<<3,f&=(1<<c)-1,e.next_in=i,e.next_out=n,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=n<a?a-n+257:257-(n-a),S.hold=f,S.bits=c};const e5=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),e6=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),e3=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),e8=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var e4=(e,t,i,r,n,s,a,o)=>{let l=o.bits,h,d,u,f,c,_,p=0,w=0,m=0,g=0,y=0,b=0,v=0,k=0,x=0,A=0,z=null,S=new Uint16Array(16),T=new Uint16Array(16),E,F,I,C=null;for(p=0;p<=15;p++)S[p]=0;for(w=0;w<r;w++)S[t[i+w]]++;for(y=l,g=15;g>=1&&0===S[g];g--);if(y>g&&(y=g),0===g)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(m=1;m<g&&0===S[m];m++);for(y<m&&(y=m),k=1,p=1;p<=15;p++)if(k<<=1,(k-=S[p])<0)return -1;if(k>0&&(0===e||1!==g))return -1;for(T[1]=0,p=1;p<15;p++)T[p+1]=T[p]+S[p];for(w=0;w<r;w++)0!==t[i+w]&&(a[T[t[i+w]]++]=w);if(0===e?(z=C=a,_=20):1===e?(z=e5,C=e6,_=257):(z=e3,C=e8,_=0),A=0,w=0,p=m,c=s,b=y,v=0,u=-1,f=(x=1<<y)-1,1===e&&x>852||2===e&&x>592)return 1;for(;;){E=p-v,a[w]+1<_?(F=0,I=a[w]):a[w]>=_?(F=C[a[w]-_],I=z[a[w]-_]):(F=96,I=0),h=1<<p-v,m=d=1<<b;do n[c+(A>>v)+(d-=h)]=E<<24|F<<16|I|0;while(0!==d)for(h=1<<p-1;A&h;)h>>=1;if(0!==h?(A&=h-1,A+=h):A=0,w++,0==--S[p]){if(p===g)break;p=t[i+a[w]]}if(p>y&&(A&f)!==u){for(0===v&&(v=y),c+=m,k=1<<(b=p-v);b+v<g&&!((k-=S[b+v])<=0);)b++,k<<=1;if(x+=1<<b,1===e&&x>852||2===e&&x>592)return 1;n[u=A&f]=y<<24|b<<16|c-s|0}}return 0!==A&&(n[c+A]=p-v<<24|4194304),o.bits=y,0};const{Z_FINISH:e9,Z_BLOCK:e7,Z_TREES:te,Z_OK:tt,Z_STREAM_END:ti,Z_NEED_DICT:tr,Z_STREAM_ERROR:tn,Z_DATA_ERROR:ts,Z_MEM_ERROR:ta,Z_BUF_ERROR:to,Z_DEFLATED:tl}=W,th=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function td(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tu=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<16180||t.mode>16211?1:0},tf=e=>{if(tu(e))return tn;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=16180,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,tt},tc=e=>{if(tu(e))return tn;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,tf(e)},t_=(e,t)=>{let i;if(tu(e))return tn;let r=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?tn:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,tc(e))},tp=(e,t)=>{if(!e)return tn;let i=new td;e.state=i,i.strm=e,i.window=null,i.mode=16180;let r=t_(e,t);return r!==tt&&(e.state=null),r};let tw,tm,tg=!0;const ty=e=>{if(tg){tw=new Int32Array(512),tm=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(e4(1,e.lens,0,288,tw,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;e4(2,e.lens,0,32,tm,0,e.work,{bits:5}),tg=!1}e.lencode=tw,e.lenbits=9,e.distcode=tm,e.distbits=5},tb=(e,t,i,r)=>{let n;let s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):((n=s.wsize-s.wnext)>r&&(n=r),s.window.set(t.subarray(i-r,i-r+n),s.wnext),(r-=n)?(s.window.set(t.subarray(i-r,i),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0};var tv={inflateReset:tc,inflateReset2:t_,inflateResetKeep:tf,inflateInit:e=>tp(e,15),inflateInit2:tp,inflate:(e,t)=>{let i,r,n,s,a,o,l,h,d,u,f,c,_,p,w,m,g,y,b,v,k,x,A,z,S=0,T=new Uint8Array(4),E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(tu(e)||!e.output||!e.input&&0!==e.avail_in)return tn;16191===(n=e.state).mode&&(n.mode=16192),l=e.next_out,a=e.output,d=e.avail_out,o=e.next_in,s=e.input,h=e.avail_in,u=n.hold,f=n.bits,c=h,_=d,z=tt;e:for(;;)switch(n.mode){case 16180:if(0===n.wrap){n.mode=16192;break}for(;f<16;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(2&n.wrap&&35615===u){0===n.wbits&&(n.wbits=15),n.check=0,T[0]=255&u,T[1]=u>>>8&255,n.check=j(n.check,T,2,0),u=0,f=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=16209;break}if((15&u)!==tl){e.msg="unknown compression method",n.mode=16209;break}if(u>>>=4,f-=4,A=8+(15&u),0===n.wbits&&(n.wbits=A),A>15||A>n.wbits){e.msg="invalid window size",n.mode=16209;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&u?16189:16191,u=0,f=0;break;case 16181:for(;f<16;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(n.flags=u,(255&n.flags)!==tl){e.msg="unknown compression method",n.mode=16209;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=16209;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=j(n.check,T,2,0)),u=0,f=0,n.mode=16182;case 16182:for(;f<32;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}n.head&&(n.head.time=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=j(n.check,T,4,0)),u=0,f=0,n.mode=16183;case 16183:for(;f<16;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=j(n.check,T,2,0)),u=0,f=0,n.mode=16184;case 16184:if(1024&n.flags){for(;f<16;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=j(n.check,T,2,0)),u=0,f=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&((p=n.length)>h&&(p=h),p&&(n.head&&(A=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(s.subarray(o,o+p),A)),512&n.flags&&4&n.wrap&&(n.check=j(n.check,s,p,o)),h-=p,o+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===h)break e;p=0;do A=s[o+p++],n.head&&A&&n.length<65536&&(n.head.name+=String.fromCharCode(A));while(A&&p<h)if(512&n.flags&&4&n.wrap&&(n.check=j(n.check,s,p,o)),h-=p,o+=p,A)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===h)break e;p=0;do A=s[o+p++],n.head&&A&&n.length<65536&&(n.head.comment+=String.fromCharCode(A));while(A&&p<h)if(512&n.flags&&4&n.wrap&&(n.check=j(n.check,s,p,o)),h-=p,o+=p,A)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;f<16;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(4&n.wrap&&u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=16209;break}u=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=16191;break;case 16189:for(;f<32;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}e.adler=n.check=th(u),u=0,f=0,n.mode=16190;case 16190:if(0===n.havedict)return e.next_out=l,e.avail_out=d,e.next_in=o,e.avail_in=h,n.hold=u,n.bits=f,tr;e.adler=n.check=1,n.mode=16191;case 16191:if(t===e7||t===te)break e;case 16192:if(n.last){u>>>=7&f,f-=7&f,n.mode=16206;break}for(;f<3;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}switch(n.last=1&u,f-=1,3&(u>>>=1)){case 0:n.mode=16193;break;case 1:if(ty(n),n.mode=16199,t===te){u>>>=2,f-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=16209}u>>>=2,f-=2;break;case 16193:for(u>>>=7&f,f-=7&f;f<32;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=16209;break}if(n.length=65535&u,u=0,f=0,n.mode=16194,t===te)break e;case 16194:n.mode=16195;case 16195:if(p=n.length){if(p>h&&(p=h),p>d&&(p=d),0===p)break e;a.set(s.subarray(o,o+p),l),h-=p,o+=p,d-=p,l+=p,n.length-=p;break}n.mode=16191;break;case 16196:for(;f<14;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(n.nlen=257+(31&u),u>>>=5,f-=5,n.ndist=1+(31&u),u>>>=5,f-=5,n.ncode=4+(15&u),u>>>=4,f-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=16209;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;f<3;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}n.lens[E[n.have++]]=7&u,u>>>=3,f-=3}for(;n.have<19;)n.lens[E[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,i={bits:n.lenbits},z=e4(0,n.lens,0,19,n.lencode,0,n.work,i),n.lenbits=i.bits,z){e.msg="invalid code lengths set",n.mode=16209;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;g=(S=n.lencode[u&(1<<n.lenbits)-1])>>>24,y=S>>>16&255,b=65535&S,!(g<=f);){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(b<16)u>>>=g,f-=g,n.lens[n.have++]=b;else{if(16===b){for(r=g+2;f<r;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(u>>>=g,f-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=16209;break}A=n.lens[n.have-1],p=3+(3&u),u>>>=2,f-=2}else if(17===b){for(r=g+3;f<r;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}u>>>=g,f-=g,A=0,p=3+(7&u),u>>>=3,f-=3}else{for(r=g+7;f<r;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}u>>>=g,f-=g,A=0,p=11+(127&u),u>>>=7,f-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=16209;break}for(;p--;)n.lens[n.have++]=A}}if(16209===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=16209;break}if(n.lenbits=9,i={bits:n.lenbits},z=e4(1,n.lens,0,n.nlen,n.lencode,0,n.work,i),n.lenbits=i.bits,z){e.msg="invalid literal/lengths set",n.mode=16209;break}if(n.distbits=6,n.distcode=n.distdyn,i={bits:n.distbits},z=e4(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,i),n.distbits=i.bits,z){e.msg="invalid distances set",n.mode=16209;break}if(n.mode=16199,t===te)break e;case 16199:n.mode=16200;case 16200:if(h>=6&&d>=258){e.next_out=l,e.avail_out=d,e.next_in=o,e.avail_in=h,n.hold=u,n.bits=f,e2(e,_),l=e.next_out,a=e.output,d=e.avail_out,o=e.next_in,s=e.input,h=e.avail_in,u=n.hold,f=n.bits,16191===n.mode&&(n.back=-1);break}for(n.back=0;g=(S=n.lencode[u&(1<<n.lenbits)-1])>>>24,y=S>>>16&255,b=65535&S,!(g<=f);){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(y&&0==(240&y)){for(v=g,k=y,x=b;g=(S=n.lencode[x+((u&(1<<v+k)-1)>>v)])>>>24,y=S>>>16&255,b=65535&S,!(v+g<=f);){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}u>>>=v,f-=v,n.back+=v}if(u>>>=g,f-=g,n.back+=g,n.length=b,0===y){n.mode=16205;break}if(32&y){n.back=-1,n.mode=16191;break}if(64&y){e.msg="invalid literal/length code",n.mode=16209;break}n.extra=15&y,n.mode=16201;case 16201:if(n.extra){for(r=n.extra;f<r;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;g=(S=n.distcode[u&(1<<n.distbits)-1])>>>24,y=S>>>16&255,b=65535&S,!(g<=f);){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(0==(240&y)){for(v=g,k=y,x=b;g=(S=n.distcode[x+((u&(1<<v+k)-1)>>v)])>>>24,y=S>>>16&255,b=65535&S,!(v+g<=f);){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}u>>>=v,f-=v,n.back+=v}if(u>>>=g,f-=g,n.back+=g,64&y){e.msg="invalid distance code",n.mode=16209;break}n.offset=b,n.extra=15&y,n.mode=16203;case 16203:if(n.extra){for(r=n.extra;f<r;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=16209;break}n.mode=16204;case 16204:if(0===d)break e;if(p=_-d,n.offset>p){if((p=n.offset-p)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=16209;break}p>n.wnext?(p-=n.wnext,w=n.wsize-p):w=n.wnext-p,p>n.length&&(p=n.length),m=n.window}else m=a,w=l-n.offset,p=n.length;p>d&&(p=d),d-=p,n.length-=p;do a[l++]=m[w++];while(--p)0===n.length&&(n.mode=16200);break;case 16205:if(0===d)break e;a[l++]=n.length,d--,n.mode=16200;break;case 16206:if(n.wrap){for(;f<32;){if(0===h)break e;h--,u|=s[o++]<<f,f+=8}if(_-=d,e.total_out+=_,n.total+=_,4&n.wrap&&_&&(e.adler=n.check=n.flags?j(n.check,a,_,l-_):Z(n.check,a,_,l-_)),_=d,4&n.wrap&&(n.flags?u:th(u))!==n.check){e.msg="incorrect data check",n.mode=16209;break}u=0,f=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;f<32;){if(0===h)break e;h--,u+=s[o++]<<f,f+=8}if(4&n.wrap&&u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=16209;break}u=0,f=0}n.mode=16208;case 16208:z=ti;break e;case 16209:z=ts;break e;case 16210:return ta;default:return tn}return e.next_out=l,e.avail_out=d,e.next_in=o,e.avail_in=h,n.hold=u,n.bits=f,(n.wsize||_!==e.avail_out&&n.mode<16209&&(n.mode<16206||t!==e9))&&tb(e,e.output,e.next_out,_-e.avail_out),c-=e.avail_in,_-=e.avail_out,e.total_in+=c,e.total_out+=_,n.total+=_,4&n.wrap&&_&&(e.adler=n.check=n.flags?j(n.check,a,_,e.next_out-_):Z(n.check,a,_,e.next_out-_)),e.data_type=n.bits+(n.last?64:0)+(16191===n.mode?128:0)+(16199===n.mode||16194===n.mode?256:0),(0===c&&0===_||t===e9)&&z===tt&&(z=to),z},inflateEnd:e=>{if(tu(e))return tn;let t=e.state;return t.window&&(t.window=null),e.state=null,tt},inflateGetHeader:(e,t)=>{if(tu(e))return tn;let i=e.state;return 0==(2&i.wrap)?tn:(i.head=t,t.done=!1,tt)},inflateSetDictionary:(e,t)=>{let i;let r=t.length;return tu(e)?tn:0!==(i=e.state).wrap&&16190!==i.mode?tn:16190===i.mode&&Z(1,t,r,0)!==i.check?ts:tb(e,t,r,r)?(i.mode=16210,ta):(i.havedict=1,tt)},inflateInfo:"pako inflate (from Nodeca project)"},tk=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const tx=Object.prototype.toString,{Z_NO_FLUSH:tA,Z_FINISH:tz,Z_OK:tS,Z_STREAM_END:tT,Z_NEED_DICT:tE,Z_STREAM_ERROR:tF,Z_DATA_ERROR:tI,Z_MEM_ERROR:tC}=W;function tB(e){this.options=eP.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ej,this.strm.avail_out=0;let i=tv.inflateInit2(this.strm,t.windowBits);if(i!==tS||(this.header=new tk,tv.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=e$.string2buf(t.dictionary):"[object ArrayBuffer]"===tx.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=tv.inflateSetDictionary(this.strm,t.dictionary))!==tS)))throw Error(H[i])}function tR(e,t){let i=new tB(t);if(i.push(e),i.err)throw i.msg||H[i.err];return i.result}tB.prototype.push=function(e,t){let i,r,n;let s=this.strm,a=this.options.chunkSize,o=this.options.dictionary;if(this.ended)return!1;for(r=t===~~t?t:!0===t?tz:tA,"[object ArrayBuffer]"===tx.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(a),s.next_out=0,s.avail_out=a),(i=tv.inflate(s,r))===tE&&o&&((i=tv.inflateSetDictionary(s,o))===tS?i=tv.inflate(s,r):i===tI&&(i=tE));s.avail_in>0&&i===tT&&s.state.wrap>0&&0!==e[s.next_in];)tv.inflateReset(s),i=tv.inflate(s,r);switch(i){case tF:case tI:case tE:case tC:return this.onEnd(i),this.ended=!0,!1}if(n=s.avail_out,s.next_out&&(0===s.avail_out||i===tT)){if("string"===this.options.to){let e=e$.utf8border(s.output,s.next_out),t=s.next_out-e,i=e$.buf2string(s.output,e);s.next_out=t,s.avail_out=a-t,t&&s.output.set(s.output.subarray(e,e+t),0),this.onData(i)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out))}if(i!==tS||0!==n){if(i===tT)return i=tv.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},tB.prototype.onData=function(e){this.chunks.push(e)},tB.prototype.onEnd=function(e){e===tS&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=eP.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const{Deflate:tD,deflate:tU,deflateRaw:tN,gzip:tL}={Deflate:e0,deflate:e1,deflateRaw:function(e,t){return(t=t||{}).raw=!0,e1(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,e1(e,t)},constants:W},{Inflate:tO,inflate:tP,inflateRaw:tM,ungzip:tZ}={Inflate:tB,inflate:tR,inflateRaw:function(e,t){return(t=t||{}).raw=!0,tR(e,t)},ungzip:tR,constants:W};for(var t$={Deflate:tD,deflate:tU,deflateRaw:tN,gzip:tL,Inflate:tO,inflate:tP,inflateRaw:tM,ungzip:tZ,constants:W},tj=function(e){var t,i,r=function(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=t);var r=i===t?0:4-i%4;return[i,r]}(e),n=r[0],s=r[1],a=new tJ(3*(n+s)/4-s),o=0,l=s>0?n-4:n;for(i=0;i<l;i+=4)t=tq[e.charCodeAt(i)]<<18|tq[e.charCodeAt(i+1)]<<12|tq[e.charCodeAt(i+2)]<<6|tq[e.charCodeAt(i+3)],a[o++]=t>>16&255,a[o++]=t>>8&255,a[o++]=255&t;return 2===s&&(t=tq[e.charCodeAt(i)]<<2|tq[e.charCodeAt(i+1)]>>4,a[o++]=255&t),1===s&&(t=tq[e.charCodeAt(i)]<<10|tq[e.charCodeAt(i+1)]<<4|tq[e.charCodeAt(i+2)]>>2,a[o++]=t>>8&255,a[o++]=255&t),a},tH=function(e){for(var t,i=e.length,r=i%3,n=[],s=0,a=i-r;s<a;s+=16383)n.push(function(e,t,i){for(var r,n=[],s=t;s<i;s+=3)n.push(tW[(r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]))>>18&63]+tW[r>>12&63]+tW[r>>6&63]+tW[63&r]);return n.join("")}(e,s,s+16383>a?a:s+16383));return 1===r?n.push(tW[(t=e[i-1])>>2]+tW[t<<4&63]+"=="):2===r&&n.push(tW[(t=(e[i-2]<<8)+e[i-1])>>10]+tW[t>>4&63]+tW[t<<2&63]+"="),n.join("")},tW=[],tq=[],tJ="undefined"!=typeof Uint8Array?Uint8Array:Array,tK="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tY=0;tY<64;++tY)tW[tY]=tK[tY],tq[tK.charCodeAt(tY)]=tY;tq["-".charCodeAt(0)]=62,tq["_".charCodeAt(0)]=63,function(){try{o.platform}catch(e){return!1}}();const tG=function(){try{if("fs"===(void 0)("fs"))return a("kjyEk"),!1}catch(e){}return!0}();function tX(e){return Uint8Array.from(e,e=>e.charCodeAt(0))}function tV(e,t="binary"){return h(this,void 0,void 0,function*(){return"function"==typeof l?l.from(e).toString(t):new Promise(i=>{let r=new FileReader;r.onloadend=()=>i(r.result),"binary"==t?r.readAsBinaryString(new Blob([e])):r.readAsText(new Blob([e]),t)})})}const tQ="function"==typeof l;function t0(e){let t=t$.deflate(e);return tQ?l.from(t).toString("base64"):tH(t)}function t1(e){let t;return t=tQ?l.from(e,"base64"):tj(e),t$.inflate(t)}class t2 extends Error{constructor(e,t=null,i=!1){if("fail"===t||"FAIL"===t||"EXIT"===t)try{e=(new TextDecoder).decode(t1(e))}catch(t){e=`decode [${e}] error: ${t}`}else t&&(e=`[TrzszError] ${t}: ${e}`);super(e),Object.setPrototypeOf(this,t2.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t2),this.name="TrzszError",this.type=t,this.trace=i}isTraceBack(){return"fail"!==this.type&&"EXIT"!==this.type&&this.trace}isRemoteExit(){return"EXIT"===this.type}isRemoteFail(){return"fail"===this.type||"FAIL"===this.type}isStopAndDelete(){return"fail"===this.type&&"Stopped and deleted"===this.message}static getErrorMessage(e){return e instanceof t2&&!e.isTraceBack()?e.message:e.stack?e.stack.replace("TrzszError: ",""):e.toString()}}function t5(e){return 97<=e&&e<=122||65<=e&&e<=90}function t6(e,t){let i=`Saved ${e.length} ${e.length>1?"files/directories":"file/directory"}`;return t.length>0&&(i+=` to ${t}`),[i].concat(e).join("\r\n- ")}const t3=t4("fs"),t8=t4("path");function t4(e){try{return require(e)}catch(e){return{}}}!function(e,t){for(let i of t)e[i+"Async"]=(...t)=>new Promise(r=>{e[i](...t,e=>r(!e))})}(t3,["rm","rmdir","unlink","access"]),function(e,t){for(let i of t)e[i+"Async"]=(...t)=>new Promise((r,n)=>{e[i](...t,(e,t)=>{e?n(e):r(t)})})}(t3,["stat","mkdir","readdir","close","open","realpath","write"]);class t9{constructor(e,t,i,r,n){this.closed=!1,this.fd=null,this.pathId=e,this.absPath=t,this.relPath=i,this.dir=r,this.size=n}getPathId(){return this.pathId}getRelPath(){return this.relPath}isDir(){return this.dir}getSize(){return this.size}readFile(e){return h(this,void 0,void 0,function*(){if(this.closed)throw new t2(`File closed: ${this.absPath}`,null,!0);null===this.fd&&(this.fd=yield t3.openAsync(this.absPath,"r"));let t=new Uint8Array(e);return function(e,t,i,r,n){return h(this,void 0,void 0,function*(){return new Promise((i,n)=>t3.read(e,t,0,r,null,(e,t,r)=>{e?n(e):i(r.subarray(0,t))}))})}(this.fd,t,0,t.length,0)})}closeFile(){return h(this,void 0,void 0,function*(){this.closed||(this.closed=!0,null!==this.fd&&(yield t3.closeAsync(this.fd),this.fd=null))})}}function t7(e,t=!1){return h(this,void 0,void 0,function*(){if(!e||!e.length)return;let i=[];for(let[r,n]of e.entries()){let e=t8.resolve(n);if(!(yield t3.accessAsync(e)))throw new t2(`No such file: ${e}`);let s=yield t3.statAsync(e);if(!t&&s.isDirectory())throw new t2(`Is a directory: ${e}`);let a=new Set;yield function e(t,i,r,n,s,a){return h(this,void 0,void 0,function*(){if(!r.isDirectory()){if(!r.isFile())throw new t2(`Not a regular file: ${i}`);if(!(yield t3.accessAsync(i,t3.constants.R_OK)))throw new t2(`No permission to read: ${i}`);return void n.push(new t9(t,i,s,!1,r.size))}let o=yield t3.realpathAsync(i);if(a.has(o))throw new t2(`Duplicate link: ${i}`);for(let r of(a.add(o),n.push(new t9(t,i,s,!0,0)),yield t3.readdirAsync(i))){let o=t8.join(i,r),l=yield t3.statAsync(o);yield e(t,o,l,n,[...s,r],a)}})}(r,e,s,i,[t8.basename(e)],a)}return i})}class ie{constructor(e,t,i,r,n=!1){this.closed=!1,this.absPath=e,this.fileName=t,this.localName=i,this.fd=r,this.dir=n}getFileName(){return this.fileName}getLocalName(){return this.localName}isDir(){return this.dir}writeFile(e){return h(this,void 0,void 0,function*(){yield t3.writeAsync(this.fd,e)})}closeFile(){return h(this,void 0,void 0,function*(){this.closed||(this.closed=!0,null!==this.fd&&(yield t3.closeAsync(this.fd),this.fd=null))})}deleteFile(){return h(this,void 0,void 0,function*(){if(!this.absPath||!(yield t3.accessAsync(this.absPath)))return"";try{if(yield this.closeFile(),"function"==typeof t3.rm){if(yield t3.rmAsync(this.absPath,{recursive:!0}))return this.absPath}else if(this.isDir){if(yield t3.rmdirAsync(this.absPath,{recursive:!0}))return this.absPath}else if(yield t3.unlinkAsync(this.absPath))return this.absPath}catch(e){console.log(`delete [${this.absPath}] failed`,e)}return""})}}function it(e,t){return h(this,void 0,void 0,function*(){if(!(yield t3.accessAsync(t8.join(e,t))))return t;for(let i=0;i<1e3;i++){let r=`${t}.${i}`;if(!(yield t3.accessAsync(t8.join(e,r))))return r}throw new t2("Fail to assign new file name")})}function ii(e){return h(this,void 0,void 0,function*(){try{return yield t3.openAsync(e,"w")}catch(t){if(-13===t.errno||-4048===t.errno)throw new t2(`No permission to write: ${e}`);if(-21===t.errno||-4068===t.errno)throw new t2(`Is a directory: ${e}`);throw t}})}function ir(e){return h(this,void 0,void 0,function*(){if(!(yield t3.accessAsync(e)))return yield t3.mkdirAsync(e,{recursive:!0,mode:493}),!0;if(!(yield t3.statAsync(e)).isDirectory())throw new t2(`Not a directory: ${e}`);return!1})}function is(e,t,i,r){return h(this,void 0,void 0,function*(){let n,s;if(!i)return function(e,t,i){return h(this,void 0,void 0,function*(){let r=i?t:yield it(e,t),n=t8.join(e,r),s=yield ii(n);return new ie(n,t,r,s)})}(e.path,t,r);let a=JSON.parse(t);if(!a.hasOwnProperty("path_name")||!a.hasOwnProperty("path_id")||!a.hasOwnProperty("is_dir")||a.path_name.length<1)throw new t2(`Invalid name: ${t}`);if(t=a.path_name[a.path_name.length-1],r?n=a.path_name[0]:e.maps.has(a.path_id)?n=e.maps.get(a.path_id):(n=yield it(e.path,a.path_name[0]),e.maps.set(a.path_id,n)),a.path_name.length>1){let i=t8.join(e.path,n,...a.path_name.slice(1,a.path_name.length-1));yield ir(i),s=t8.join(i,t)}else s=t8.join(e.path,n);if(!0===a.is_dir){let e="";return(yield ir(s))&&(e=s),new ie(e,t,n,null,!0)}let o=yield ii(s);return new ie(s,t,n,o)})}class ia{constructor(e,t,i,r){this.closed=!1,this.pos=0,this.pathId=e,this.relPath=t,this.file=i,this.dir=r}getPathId(){return this.pathId}getRelPath(){return this.relPath}isDir(){return this.dir}getSize(){return this.file.size}readFile(e){return h(this,void 0,void 0,function*(){if(this.pos>=this.file.size)return new Uint8Array(0);try{let t=Math.min(e.byteLength,this.file.size-this.pos),i=this.file.slice(this.pos,this.pos+t);return this.pos+=t,new Uint8Array((yield i.arrayBuffer()))}catch(e){if("NotReadableError"===e.name)throw new t2(`No permission to read: ${this.relPath.join("/")}`);throw new t2(`Read ${this.relPath.join("/")} error: ${e.toString()}`)}})}closeFile(){this.closed||(this.file=null,this.closed=!0)}}function il(){return new t2("https:"===window.location.protocol||["localhost","127.0.0.1","[::1]"].includes(window.location.hostname)?"The browser doesn't support the File System Access API":"The File System Access API requires HTTPS except localhost")}class ih{constructor(e,t,i,r=!1){this.closed=!1,this.fileName=e,this.localName=t,this.writer=i,this.dir=r}getFileName(){return this.fileName}getLocalName(){return this.localName}isDir(){return this.dir}writeFile(e){return h(this,void 0,void 0,function*(){yield this.writer.write(e)})}closeFile(){this.closed||(this.writer.close(),this.writer=null,this.closed=!0)}deleteFile(){return h(this,void 0,void 0,function*(){return""})}}function id(e,t){var i,r,n,s;return h(this,void 0,void 0,function*(){let a=new Set;try{for(var o,l=!0,h=d(e.values());!(i=(o=yield h.next()).done);l=!0)s=o.value,l=!1,a.add(s.name)}catch(e){r={error:e}}finally{try{!l&&!i&&(n=h.return)&&(yield n.call(h))}finally{if(r)throw r.error}}if(!a.has(t))return t;for(let e=0;e<1e3;e++){let i=`${t}.${e}`;if(!a.has(i))return i}})}function iu(e,t){return h(this,void 0,void 0,function*(){try{let i=yield e.getFileHandle(t[t.length-1],{create:!0});return yield i.createWritable()}catch(e){if("NoModificationAllowedError"===e.name)throw new t2(`No permission to write: ${t.join("/")}`);if("TypeMismatchError"===e.name)throw new t2(`Is a directory: ${t.join("/")}`);throw new t2(`Write ${t.join("/")} error: ${e.toString()}`)}})}function ic(e,t){return h(this,void 0,void 0,function*(){try{return yield e.getDirectoryHandle(t[t.length-1],{create:!0})}catch(e){if("InvalidStateError"===e.name)throw new t2(`No permission to create: ${t.join("/")}`);if("TypeMismatchError"===e.name)throw new t2(`Not a directory: ${t.join("/")}`);throw new t2(`Create ${t.join("/")} error: ${e.toString()}`)}})}function i_(e,t,i,r){return h(this,void 0,void 0,function*(){let n;let s=e.handle;if(!i)return yield function(e,t,i){return h(this,void 0,void 0,function*(){let r=i?t:yield id(e,t),n=yield iu(e,[e.name,r]);return new ih(t,r,n)})}(s,t,r);let a=JSON.parse(t);if(!a.hasOwnProperty("path_name")||!a.hasOwnProperty("path_id")||!a.hasOwnProperty("is_dir")||a.path_name.length<1)throw new t2(`Invalid name: ${t}`);t=a.path_name[a.path_name.length-1],r?n=a.path_name[0]:e.maps.has(a.path_id)?n=e.maps.get(a.path_id):(n=yield id(s,a.path_name[0]),e.maps.set(a.path_id,n));let o=s,l=[s.name,n];if(a.path_name.length>1){o=yield ic(o,l);for(let e=1;e<a.path_name.length-1;e++)l.push(a.path_name[e]),o=yield ic(o,l);l.push(t)}if(!0===a.is_dir)return yield ic(o,l),new ih(t,n,null,!0);let d=yield a.readAsBuffer(),u=new Blob([d],{type:"application/octet-stream"}),f=document.createElement("a");f.href=URL.createObjectURL(u),f.download=a.name,document.body.appendChild(f),f.click(),document.body.removeChild(f);let c=yield iu(o,l);return new ih(t,n,c)})}class ip{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){let t,i,r,n;let s=ip.hexChars,a=ip.hexOut;for(n=0;n<4;n+=1)for(i=8*n,t=e[n],r=0;r<8;r+=2)a[i+1+r]=s.charAt(15&t),t>>>=4,a[i+0+r]=s.charAt(15&t),t>>>=4;return a.join("")}static _md5cycle(e,t){let i=e[0],r=e[1],n=e[2],s=e[3];i+=(r&n|~r&s)+t[0]-680876936|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[1]-389564586|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[2]+606105819|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[3]-1044525330|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[4]-176418897|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[5]+1200080426|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[6]-1473231341|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[7]-45705983|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[8]+1770035416|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[9]-1958414417|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[10]-42063|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[11]-1990404162|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[12]+1804603682|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[13]-40341101|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[14]-1502002290|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[15]+1236535329|0,i+=((r=(r<<22|r>>>10)+n|0)&s|n&~s)+t[1]-165796510|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[6]-1069501632|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[11]+643717713|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[0]-373897302|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[5]-701558691|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[10]+38016083|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[15]-660478335|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[4]-405537848|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[9]+568446438|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[14]-1019803690|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[3]-187363961|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[8]+1163531501|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[13]-1444681467|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[2]-51403784|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[7]+1735328473|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[12]-1926607734|0,i+=((r=(r<<20|r>>>12)+n|0)^n^s)+t[5]-378558|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[8]-2022574463|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[11]+1839030562|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[14]-35309556|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[1]-1530992060|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[4]+1272893353|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[7]-155497632|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[10]-1094730640|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[13]+681279174|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[0]-358537222|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[3]-722521979|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[6]+76029189|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[9]-640364487|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[12]-421815835|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[15]+530742520|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[2]-995338651|0,r=(r<<23|r>>>9)+n|0,i+=(n^(r|~s))+t[0]-198630844|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[7]+1126891415|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[14]-1416354905|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[5]-57434055|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[12]+1700485571|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[3]-1894986606|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[10]-1051523|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[1]-2054922799|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[8]+1873313359|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[15]-30611744|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[6]-1560198380|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[13]+1309151649|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[4]-145523070|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[11]-1120210379|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[2]+718787259|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[9]-343485551|0,r=(r<<21|r>>>11)+n|0,e[0]=i+e[0]|0,e[1]=r+e[1]|0,e[2]=n+e[2]|0,e[3]=s+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(ip.stateIdentity),this}appendStr(e){let t=this._buffer8,i=this._buffer32,r,n,s=this._bufferLength;for(n=0;n<e.length;n+=1){if((r=e.charCodeAt(n))<128)t[s++]=r;else if(r<2048)t[s++]=192+(r>>>6),t[s++]=63&r|128;else if(r<55296||r>56319)t[s++]=224+(r>>>12),t[s++]=r>>>6&63|128,t[s++]=63&r|128;else{if((r=1024*(r-55296)+(e.charCodeAt(++n)-56320)+65536)>1114111)throw Error("Unicode standard supports code points up to U+10FFFF");t[s++]=240+(r>>>18),t[s++]=r>>>12&63|128,t[s++]=r>>>6&63|128,t[s++]=63&r|128}s>=64&&(this._dataLength+=64,ip._md5cycle(this._state,i),s-=64,i[0]=i[16])}return this._bufferLength=s,this}appendAsciiStr(e){let t=this._buffer8,i=this._buffer32,r,n=this._bufferLength,s=0;for(;;){for(r=Math.min(e.length-s,64-n);r--;)t[n++]=e.charCodeAt(s++);if(n<64)break;this._dataLength+=64,ip._md5cycle(this._state,i),n=0}return this._bufferLength=n,this}appendByteArray(e){let t=this._buffer8,i=this._buffer32,r,n=this._bufferLength,s=0;for(;;){for(r=Math.min(e.length-s,64-n);r--;)t[n++]=e[s++];if(n<64)break;this._dataLength+=64,ip._md5cycle(this._state,i),n=0}return this._bufferLength=n,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t;let i=e.buffer,r=e.state,n=this._state;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],t=0;t<i.length;t+=1)this._buffer8[t]=i.charCodeAt(t)}end(e=!1){let t=this._bufferLength,i=this._buffer8,r=this._buffer32,n=1+(t>>2);this._dataLength+=t;let s=8*this._dataLength;if(i[t]=128,i[t+1]=i[t+2]=i[t+3]=0,r.set(ip.buffer32Identity.subarray(n),n),t>55&&(ip._md5cycle(this._state,r),r.set(ip.buffer32Identity)),s<=4294967295)r[14]=s;else{let e=s.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;let t=parseInt(e[2],16),i=parseInt(e[1],16)||0;r[14]=t,r[15]=i}return ip._md5cycle(this._state,r),e?this._state:ip._hex(this._state)}}if(ip.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),ip.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ip.hexChars="0123456789abcdef",ip.hexOut=[],ip.onePassHasher=new ip,"5d41402abc4b2a76b9719d911017c592"!==ip.hashStr("hello"))throw Error("Md5 self test failed.");class iw{constructor(){this.bufArray=[],this.resolve=null,this.reject=null,this.bufHead=0,this.bufTail=0,this.nextIdx=0,this.nextBuf=null,this.arrBuf=new ArrayBuffer(128)}addBuffer(e){this.bufArray[this.bufTail++]=e,this.resolve&&(this.resolve(),this.resolve=null,this.reject=null)}stopBuffer(){this.reject&&(this.reject(new t2("Stopped")),this.reject=null,this.resolve=null)}drainBuffer(){this.bufArray=[],this.bufHead=0,this.bufTail=0}toUint8Array(e){return h(this,void 0,void 0,function*(){if("string"==typeof e)return tX(e);if(e instanceof ArrayBuffer)return new Uint8Array(e);if(e instanceof Uint8Array)return e;if(e instanceof Blob){let t=yield e.arrayBuffer();return new Uint8Array(t)}throw new t2("The buffer type is not supported",null,!0)})}nextBuffer(){return h(this,void 0,void 0,function*(){if(this.nextBuf&&this.nextIdx<this.nextBuf.length)return this.nextBuf.subarray(this.nextIdx);this.bufHead===this.bufTail&&(0!==this.bufHead&&(this.bufHead=0,this.bufTail=0),yield new Promise((e,t)=>{this.resolve=e,this.reject=t}));let e=this.bufArray[this.bufHead];return this.bufArray[this.bufHead]=null,this.bufHead++,this.nextBuf=yield this.toUint8Array(e),this.nextIdx=0,this.nextBuf})}growBuffer(e,t,i){let r=Math.max(2*e.length,t+i);this.arrBuf=new ArrayBuffer(r);let n=new Uint8Array(this.arrBuf);return n.set(e.subarray(0,t)),n}appendBuffer(e,t,i){let r=e.length>=t+i.length?e:this.growBuffer(e,t,i.length);return r.set(i,t),r}readLine(){return h(this,void 0,void 0,function*(){let e=new Uint8Array(this.arrBuf),t=0;for(;;){let i=yield this.nextBuffer(),r=i.indexOf(10);if(r>=0?(this.nextIdx+=r+1,i=i.subarray(0,r)):this.nextIdx+=i.length,i.includes(3))throw new t2("Interrupted");if(e=this.appendBuffer(e,t,i),t+=i.length,r>=0)return tV(e.subarray(0,t))}})}readBinary(e){return h(this,void 0,void 0,function*(){this.arrBuf.byteLength<e&&(this.arrBuf=new ArrayBuffer(e));let t=new Uint8Array(this.arrBuf,0,e),i=0;for(;i<e;){let r=e-i,n=yield this.nextBuffer();n.length>r?(this.nextIdx+=r,n=n.subarray(0,r)):this.nextIdx+=n.length,t.set(n,i),i+=n.length}return t})}readLineOnWindows(){return h(this,void 0,void 0,function*(){let e=new Uint8Array(this.arrBuf),t=27,i=!1,r=!1,n=!1,s=!1,a=!1,o=0;for(;;){let l=yield this.nextBuffer(),h=l.indexOf(33);h>=0?(this.nextIdx+=h+1,l=l.subarray(0,h)):this.nextIdx+=l.length;for(let h=0;h<l.length;h++){let d=l[h];if(3==d)throw new t2("Interrupted");if(10==d&&(r=!0),i)t5(d)&&(i=!1,72==d&&t>=48&&t<=57&&(n=!0)),91==t&&72==d&&(s=!0),t=d;else if(27==d)i=!0,t=d;else if(97<=d&&d<=122||65<=d&&d<=90||48<=d&&d<=57||35==d||58==d||43==d||47==d||61==d){if(n&&(n=!1,r&&o>0&&(d==e[o-1]||a))){e[o-1]=d;continue}o>=e.length&&(e=this.growBuffer(e,o,l.length)),e[o++]=d,a=s,s=!1,r=!1}}if(h>=0&&o>0&&!i)return tV(e.subarray(0,o))}})}}function im(e){let t=[];for(let i=0;i<e.length;i++)t.push([e[i][0].charCodeAt(0),e[i][1].charCodeAt(0),e[i][1].charCodeAt(1)]);return t}class ig{constructor(e,t=!1){this.buffer=new iw,this.remoteIsWindows=!1,this.lastInputTime=0,this.openedFiles=[],this.createdFiles=[],this.tmuxOutputJunk=!1,this.cleanTimeoutInMilliseconds=100,this.transferConfig={},this.stopped=!1,this.maxChunkTimeInMilliseconds=0,this.protocolNewline="\n",this.writer=e,this.isWindowsShell=t}cleanup(){for(let e of this.openedFiles)e.closeFile()}addReceivedData(e){this.stopped||this.buffer.addBuffer(e),this.lastInputTime=Date.now()}stopTransferring(){return h(this,void 0,void 0,function*(){this.cleanTimeoutInMilliseconds=Math.max(2*this.maxChunkTimeInMilliseconds,500),this.stopped=!0,this.buffer.stopBuffer()})}cleanInput(e){return h(this,void 0,void 0,function*(){for(this.stopped=!0,this.buffer.drainBuffer(),this.lastInputTime=Date.now();;){let t=e-(Date.now()-this.lastInputTime);if(t<=0)return;yield new Promise(e=>setTimeout(e,t))}})}sendLine(e,t){return h(this,void 0,void 0,function*(){this.writer(`#${e}:${t}${this.protocolNewline}`)})}recvLine(e,t=!1){return h(this,void 0,void 0,function*(){if(this.stopped)throw new t2("Stopped");if(this.isWindowsShell||this.remoteIsWindows){let t=yield this.buffer.readLineOnWindows(),i=t.lastIndexOf("#"+e+":");if(i>=0)t=t.substring(i);else{let e=t.lastIndexOf("#");e>0&&(t=t.substring(e))}return t}let i=yield this.buffer.readLine();if(this.tmuxOutputJunk||t){if(i.length>0)for(;"\r"===i[i.length-1];)i=i.substring(0,i.length-1)+(yield this.buffer.readLine());let t=i.lastIndexOf("#"+e+":");if(t>=0)i=i.substring(t);else{let e=i.lastIndexOf("#");e>0&&(i=i.substring(e))}i=function(e){for(;;){let t=e.indexOf("\x1bP=");if(t<0)return e;let i=t+3,r=e.substring(i).indexOf("\x1bP=");if(r<0)return e.substring(0,t);i+=r+3;let n=e.substring(i).indexOf("\x1b\\");if(n<0)return e.substring(0,t);i+=n+2,e=e.substring(0,t)+e.substring(i)}}(i)}return i})}recvCheck(e,t=!1){return h(this,void 0,void 0,function*(){let i=yield this.recvLine(e,t),r=i.indexOf(":");if(r<1)throw new t2(t0(i),"colon",!0);let n=i.substring(1,r),s=i.substring(r+1);if(n!=e)throw new t2(s,n,!0);return s})}sendInteger(e,t){return h(this,void 0,void 0,function*(){yield this.sendLine(e,t.toString())})}recvInteger(e,t=!1){return h(this,void 0,void 0,function*(){return Number((yield this.recvCheck(e,t)))})}checkInteger(e){return h(this,void 0,void 0,function*(){let t=yield this.recvInteger("SUCC");if(t!==e)throw new t2(`Integer check [${t}] <> [${e}]`,null,!0)})}sendString(e,t){return h(this,void 0,void 0,function*(){yield this.sendLine(e,t0(t))})}recvString(e,t=!1){return h(this,void 0,void 0,function*(){return tV(t1((yield this.recvCheck(e,t))),"utf8")})}checkString(e){return h(this,void 0,void 0,function*(){let t=yield this.recvString("SUCC");if(t!==e)throw new t2(`String check [${t}] <> [${e}]`,null,!0)})}sendBinary(e,t){return h(this,void 0,void 0,function*(){yield this.sendLine(e,t0(t))})}recvBinary(e,t=!1){return h(this,void 0,void 0,function*(){return t1((yield this.recvCheck(e,t)))})}checkBinary(e){return h(this,void 0,void 0,function*(){let t=yield this.recvBinary("SUCC");if(t.length!=e.length)throw new t2(`Binary length check [${t.length}] <> [${e.length}]`,null,!0);for(let i=0;i<t.length;i++)if(t[i]!=e[i])throw new t2(`Binary check [${t[i]}] <> [${e[i]}]`,null,!0)})}sendData(e,t,i){return h(this,void 0,void 0,function*(){if(!t)return void(yield this.sendBinary("DATA",e));let r=function(e,t){if(!t.length)return e;let i=new Uint8Array(2*e.length),r=0;for(let n=0;n<e.length;n++){let s=-1;for(let i=0;i<t.length;i++)if(e[n]==t[i][0]){s=i;break}s<0?i[r++]=e[n]:(i[r++]=t[s][1],i[r++]=t[s][2])}return i.subarray(0,r)}(e,i);this.writer(`#DATA:${r.length}
`),this.writer(r)})}recvData(e,t,i){return h(this,void 0,void 0,function*(){return yield Promise.race([new Promise((e,t)=>setTimeout(()=>{this.cleanTimeoutInMilliseconds=3e3,t(new t2("Receive data timeout"))},i)),h(this,void 0,void 0,function*(){if(!e)return yield this.recvBinary("DATA");let i=yield this.recvInteger("DATA");return function(e,t){if(!t.length)return e;let i=new Uint8Array(e.length),r=0;for(let n=0;n<e.length;n++){let s=-1;if(n<e.length-1){for(let i=0;i<t.length;i++)if(e[n]==t[i][1]&&e[n+1]==t[i][2]){s=i;break}}s<0?i[r++]=e[n]:(i[r++]=t[s][0],n++)}return i.subarray(0,r)}((yield this.buffer.readBinary(i)),t)})])})}sendAction(e,t){return h(this,void 0,void 0,function*(){let i={lang:"js",confirm:e,version:"1.1.5",support_dir:!0};(this.isWindowsShell||t)&&(i.binary=!1,i.newline="!\n"),t&&(this.remoteIsWindows=!0,this.protocolNewline="!\n"),yield this.sendString("ACT",JSON.stringify(i))})}recvAction(){return h(this,void 0,void 0,function*(){let e=JSON.parse((yield this.recvString("ACT",!0)));return e.newline&&(this.protocolNewline=e.newline),e})}sendConfig(e,t,i,r){return h(this,void 0,void 0,function*(){let n={lang:"js"};e.quiet&&(n.quiet=!0),e.binary&&(n.binary=!0,n.escape_chars=t),e.directory&&(n.directory=!0),e.bufsize&&(n.bufsize=e.bufsize),e.timeout&&(n.timeout=e.timeout),e.overwrite&&(n.overwrite=!0),1==i&&(n.tmux_output_junk=!0),r>0&&(n.tmux_pane_width=r);let s=JSON.stringify(n);s=s.replace(/[\u007F-\uFFFF]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}),this.transferConfig=n,yield this.sendString("CFG",s)})}recvConfig(){return h(this,void 0,void 0,function*(){let e=yield this.recvString("CFG",!0);return this.transferConfig=JSON.parse(e),this.tmuxOutputJunk=!0===this.transferConfig.tmux_output_junk,this.transferConfig})}clientExit(e){return h(this,void 0,void 0,function*(){yield this.sendString("EXIT",e)})}recvExit(){return h(this,void 0,void 0,function*(){return this.recvString("EXIT")})}serverExit(e){return h(this,void 0,void 0,function*(){yield this.cleanInput(500),yield function(){return h(this,void 0,void 0,function*(){})}(),this.isWindowsShell?(e=e.replace(/\n/g,"\r\n"),o.stdout.write("\x1b[H\x1b[2J\x1b[?1049l")):o.stdout.write("\x1b8\x1b[0J"),o.stdout.write(e),o.stdout.write("\r\n"),o.stdout.write("\x1b[?25h"),this.transferConfig.tmux_output_junk&&(yield function(){return h(this,void 0,void 0,function*(){let e=a("N7Lcz").promisify(a("kjyEk").exec);yield e("tmux refresh-client")})}())})}deleteCreatedFiles(){return h(this,void 0,void 0,function*(){let e=[];for(let t of this.createdFiles){let i=yield t.deleteFile();i&&e.push(i)}return e})}clientError(e){return h(this,void 0,void 0,function*(){yield this.cleanInput(this.cleanTimeoutInMilliseconds);let t=t2.getErrorMessage(e),i=!0;if(e instanceof t2){if(i=e.isTraceBack(),e.isRemoteExit())return;if(e.isRemoteFail())return void(i&&console.log(t))}yield this.sendString(i?"FAIL":"fail",t),i&&console.log(t)})}serverError(e){return h(this,void 0,void 0,function*(){yield this.cleanInput(this.cleanTimeoutInMilliseconds);let t=t2.getErrorMessage(e),i=!0;if(e instanceof t2){if(e.isStopAndDelete()){let t=yield this.deleteCreatedFiles();if(t&&t.length)return void(yield this.serverExit([e.message+":"].concat(t).join("\r\n- ")))}if(i=e.isTraceBack(),e.isRemoteExit()||e.isRemoteFail())return void(yield this.serverExit(t))}yield this.sendString(i?"FAIL":"fail",t),yield this.serverExit(t)})}sendFileNum(e,t){return h(this,void 0,void 0,function*(){yield this.sendInteger("NUM",e),yield this.checkInteger(e),t&&t.onNum(e)})}sendFileName(e,t,i){return h(this,void 0,void 0,function*(){let r=e.getRelPath(),n=r[r.length-1];if(t){let t={path_id:e.getPathId(),path_name:r,is_dir:e.isDir()};yield this.sendString("NAME",JSON.stringify(t))}else yield this.sendString("NAME",n);let s=yield this.recvString("SUCC");return i&&i.onName(n),s})}sendFileSize(e,t){return h(this,void 0,void 0,function*(){yield this.sendInteger("SIZE",e),yield this.checkInteger(e),t&&t.onSize(e)})}sendFileData(e,t,i,r,n,s){return h(this,void 0,void 0,function*(){let a=0;s&&s.onStep(a);let o=1024,l=new ArrayBuffer(o),h=new ip;for(;a<t;){let t=Date.now(),d=yield e.readFile(l);yield this.sendData(d,i,r),h.appendByteArray(d),yield this.checkInteger(d.length),a+=d.length,s&&s.onStep(a);let u=Date.now()-t;d.length==o&&u<500&&o<n?(o=Math.min(2*o,n),l=new ArrayBuffer(o)):u>=2e3&&o>1024&&(o=1024,l=new ArrayBuffer(o)),u>this.maxChunkTimeInMilliseconds&&(this.maxChunkTimeInMilliseconds=u)}return new Uint8Array(h.end(!0).buffer)})}sendFileMD5(e,t){return h(this,void 0,void 0,function*(){yield this.sendBinary("MD5",e),yield this.checkBinary(e),t&&t.onDone()})}sendFiles(e,t){return h(this,void 0,void 0,function*(){this.openedFiles.push(...e);let i=!0===this.transferConfig.binary,r=!0===this.transferConfig.directory,n=this.transferConfig.bufsize||10485760,s=this.transferConfig.escape_chars?im(this.transferConfig.escape_chars):[];yield this.sendFileNum(e.length,t);let a=[];for(let o of e){let e=yield this.sendFileName(o,r,t);if(a.includes(e)||a.push(e),o.isDir())continue;let l=o.getSize();yield this.sendFileSize(l,t);let h=yield this.sendFileData(o,l,i,s,n,t);o.closeFile(),yield this.sendFileMD5(h,t)}return a})}recvFileNum(e){return h(this,void 0,void 0,function*(){let t=yield this.recvInteger("NUM");return yield this.sendInteger("SUCC",t),e&&e.onNum(t),t})}recvFileName(e,t,i,r,n){return h(this,void 0,void 0,function*(){let s=yield this.recvString("NAME"),a=yield t(e,s,i,r);return this.createdFiles.push(a),yield this.sendString("SUCC",a.getLocalName()),n&&n.onName(a.getFileName()),a})}recvFileSize(e){return h(this,void 0,void 0,function*(){let t=yield this.recvInteger("SIZE");return yield this.sendInteger("SUCC",t),e&&e.onSize(t),t})}recvFileData(e,t,i,r,n,s){return h(this,void 0,void 0,function*(){let a=0;s&&s.onStep(a);let o=new ip;for(;a<t;){let t=Date.now(),l=yield this.recvData(i,r,n);yield e.writeFile(l),a+=l.length,s&&s.onStep(a),yield this.sendInteger("SUCC",l.length),o.appendByteArray(l);let h=Date.now()-t;h>this.maxChunkTimeInMilliseconds&&(this.maxChunkTimeInMilliseconds=h)}return new Uint8Array(o.end(!0).buffer)})}recvFileMD5(e,t){return h(this,void 0,void 0,function*(){let i=yield this.recvBinary("MD5");if(e.length!=i.length)throw new t2("Check MD5 failed");for(let t=0;t<e.length;t++)if(e[t]!=i[t])throw new t2("Check MD5 failed");yield this.sendBinary("SUCC",e),t&&t.onDone()})}recvFiles(e,t,i){return h(this,void 0,void 0,function*(){let r=!0===this.transferConfig.binary,n=!0===this.transferConfig.directory,s=!0===this.transferConfig.overwrite,a=this.transferConfig.timeout?1e3*this.transferConfig.timeout:1e5,o=this.transferConfig.escape_chars?im(this.transferConfig.escape_chars):[],l=yield this.recvFileNum(i),h=[];for(let d=0;d<l;d++){let l=yield this.recvFileName(e,t,n,s,i);if(h.includes(l.getLocalName())||h.push(l.getLocalName()),l.isDir())continue;this.openedFiles.push(l);let d=yield this.recvFileSize(i),u=yield this.recvFileData(l,d,r,o,a,i);l.closeFile(),yield this.recvFileMD5(u,i)}return h})}}function iy(e,t){t-=3;let i=0,r="";for(let n=0;n<e.length;n++){if(e.charCodeAt(n)>=19968&&40869>=e.charCodeAt(n)){if(i+2>t)return{sub:r+"...",len:i+3};i+=2}else{if(i+1>t)return{sub:r+"...",len:i+3};i+=1}r+=e[n]}return{sub:r+"...",len:i+3}}function ib(e){let t="B";do{if(e<1024||(t="KB",(e/=1024)<1024)||(t="MB",(e/=1024)<1024)||(t="GB",(e/=1024)<1024))break;e/=1024,t="TB"}while(0)return e>=100?`${e.toFixed(0)} ${t}`:e>=10?`${e.toFixed(1)} ${t}`:`${e.toFixed(2)} ${t}`}class iv{constructor(e,t,i){this.lastUpdateTime=0,this.firstWrite=!0,this.speedCnt=0,this.speedIdx=0,this.timeArray=Array(30),this.stepArray=Array(30),this.writer=e,this.tmuxPaneColumns=i||0,this.columns=this.tmuxPaneColumns>1?this.tmuxPaneColumns-1:t}setTerminalColumns(e){this.columns=e,this.tmuxPaneColumns>0&&(this.tmuxPaneColumns=0)}onNum(e){this.fileCount=e,this.fileIdx=0}onName(e){this.fileName=e,this.fileIdx+=1,this.startTime=Date.now(),this.timeArray[0]=this.startTime,this.stepArray[0]=0,this.speedCnt=1,this.speedIdx=1,this.fileStep=-1}onSize(e){this.fileSize=e}onStep(e){e<=this.fileStep||(this.fileStep=e,this.showProgress())}hideCursor(){this.writer("\x1b[?25l")}showCursor(){this.writer("\x1b[?25h")}showProgress(){let e=Date.now();if(e-this.lastUpdateTime<200)return;this.lastUpdateTime=e;let t="100%";0!=this.fileSize&&(t=Math.round(100*this.fileStep/this.fileSize).toString()+"%");let i=ib(this.fileStep),r=this.getSpeed(e),n="--- B/s",s="--- ETA";r>0&&(n=ib(r)+"/s",s=function(e){let t="";e>=3600&&(t+=Math.floor(e/3600).toString()+":",e%=3600);let i=Math.floor(e/60);t+=(i>=10?i.toString():"0"+i.toString())+":";let r=Math.round(e%60);return t+(r>=10?r.toString():"0"+r.toString())}(Math.round((this.fileSize-this.fileStep)/r))+" ETA");let a=this.getProgressText(t,i,n,s);if(this.firstWrite)return this.firstWrite=!1,void this.writer(a);this.tmuxPaneColumns>0?this.writer(`[${this.columns}D${a}`):this.writer(`\r${a}`)}getSpeed(e){let t;return this.speedCnt<=30?(this.speedCnt++,t=1e3*(this.fileStep-this.stepArray[0])/(e-this.timeArray[0])):t=1e3*(this.fileStep-this.stepArray[this.speedIdx])/(e-this.timeArray[this.speedIdx]),this.timeArray[this.speedIdx]=e,this.stepArray[this.speedIdx]=this.fileStep,this.speedIdx++,this.speedIdx>=30&&(this.speedIdx%=30),isFinite(t)?t:-1}getProgressText(e,t,i,r){let n=this.fileCount>1?`(${this.fileIdx}/${this.fileCount}) ${this.fileName}`:this.fileName,s=n.replace(/[\u4e00-\u9fa5]/g,"**").length,a=` ${e} | ${t} | ${i} | ${r}`;do{if(this.columns-s-a.length>=24||(s>50&&({sub:n,len:s}=iy(n,50)),this.columns-s-a.length>=24)||(s>40&&({sub:n,len:s}=iy(n,40)),this.columns-s-a.length>=24)||(a=` ${e} | ${i} | ${r}`,this.columns-s-a.length>=24)||(s>30&&({sub:n,len:s}=iy(n,30)),this.columns-s-a.length>=24)||(a=` ${e} | ${r}`,this.columns-s-a.length>=24)||(a=` ${e}`,this.columns-s-a.length>=24)||(s>20&&({sub:n,len:s}=iy(n,20)),this.columns-s-a.length>=24))break;n="",s=0}while(0)let o=this.columns-a.length;return s>0&&(o-=s+1,n+=" "),(n+this.getProgressBar(o)+a).trim()}getProgressBar(e){if(e<12)return"";let t=e-2,i=t;return 0!=this.fileSize&&(i=Math.round(t*this.fileStep/this.fileSize)),"[\x1b[36m"+"█".repeat(i)+"░".repeat(t-i)+"\x1b[0m]"}onDone(){0!=this.fileSize&&(this.fileStep=this.fileSize,this.lastUpdateTime=0,this.showProgress())}}const ik="::TRZSZ:TRANSFER:",ix=new RegExp(/::TRZSZ:TRANSFER:([SRD]):(\d+\.\d+\.\d+)(:\d+)?/),iA=new Float64Array(tX(ik).buffer,0,2);var iz=function(e){for(var t=encodeURIComponent(e),i="",r=0;r<t.length;){var n=t[r];if(r+=1,"%"==n){var s=t.substring(r,r+=2);s&&(i+=String.fromCharCode(parseInt(s,16)))}else i+=n}return i};const{createApp:iS}=Vue;var iT=null,iE=null,iF=null,iI=null;const iC=document.getElementById("terminal");let iB="",iR=!1;const iD="http://localhost:5000/pty",iU="echo $CODE | base64 --decode",iN=new class{constructor(e){if(this.trzszTransfer=null,this.textProgressBar=null,this.uniqueIdMaps=new Map,this.uploadFilesList=null,this.uploadFilesResolve=null,this.uploadFilesReject=null,this.uploadInterrupting=!1,this.uploadSkipTrzCommand=!1,!e)throw new t2("TrzszOptions is required");if(!e.writeToTerminal)throw new t2("TrzszOptions.writeToTerminal is required");if(this.writeToTerminal=e.writeToTerminal,!e.sendToServer)throw new t2("TrzszOptions.sendToServer is required");if(this.sendToServer=e.sendToServer,!tG&&!e.chooseSendFiles)throw new t2("TrzszOptions.chooseSendFiles is required when having a node runtime environment");if(this.chooseSendFiles=e.chooseSendFiles,!tG&&!e.chooseSaveDirectory)throw new t2("TrzszOptions.chooseSaveDirectory is required when having a node runtime environment");this.chooseSaveDirectory=e.chooseSaveDirectory,this.terminalColumns=e.terminalColumns||80,this.isWindowsShell=!!e.isWindowsShell,this.dragInitTimeout=e.dragInitTimeout||3e3}processServerOutput(e){if(this.isTransferringFiles())this.trzszTransfer.addReceivedData(e);else if(!this.uploadInterrupting){if(this.uploadSkipTrzCommand){this.uploadSkipTrzCommand=!1;let t=function(e){let t;if("string"==typeof e)t=tX(e);else if(e instanceof ArrayBuffer)t=new Uint8Array(e);else{if(!(e instanceof Uint8Array))return e;t=e}let i=new Uint8Array(t.length),r=!1,n=0;for(let e=0;e<t.length;e++){let s=t[e];r?t5(s)&&(r=!1):27==s?r=!0:i[n++]=s}for(;n>0;){let e=i[n-1];if(13!=e&&10!=e)break;n--}let s=i.subarray(0,n);return s.length>100?e:String.fromCharCode.apply(null,s)}(e);if("trz"===t||"trz -d"===t)return void this.writeToTerminal("\r\n")}setTimeout(()=>this.detectAndHandleTrzsz(e),10),this.writeToTerminal(e)}}processTerminalInput(e){this.isTransferringFiles()?"\x03"===e&&this.stopTransferringFiles():this.sendToServer(e)}processBinaryInput(e){this.isTransferringFiles()||this.sendToServer(tX(e))}setTerminalColumns(e){this.terminalColumns=e,null!=this.textProgressBar&&this.textProgressBar.setTerminalColumns(e)}isTransferringFiles(){return null!=this.trzszTransfer}stopTransferringFiles(){this.isTransferringFiles()&&this.trzszTransfer.stopTransferring()}uploadFiles(e){return h(this,void 0,void 0,function*(){if(this.uploadFilesList||this.isTransferringFiles())throw Error("The previous upload has not been completed yet");if(e instanceof DataTransferItemList||e instanceof FileList)this.uploadFilesList=yield function(e){return h(this,void 0,void 0,function*(){let t=[],i=[];if(e instanceof FileList)for(let t of e)i.push({isFile:!0,isDirectory:!1,name:t.name,fullPath:"/"+t.name,file:e=>e(t)});else for(let t of e){let e=t.webkitGetAsEntry();e&&i.push(e)}for(let e=0;e<i.length;e++){let r=i[e];r&&(yield function e(t,i,r,n){return h(this,void 0,void 0,function*(){i.isFile?yield new Promise(e=>{i.file(i=>{r.push(new ia(t,n,i,!1)),e()})}):i.isDirectory&&(r.push(new ia(t,n,null,!0)),yield new Promise(s=>{i.createReader().readEntries(i=>h(this,void 0,void 0,function*(){for(let s of i)yield e(t,s,r,[...n,s.name]);s()}))}))})}(e,r,t,[r.name]))}return t})}(e);else{if(!function(e,t){if(!Array.isArray(e))return!1;for(let i of e)if(typeof i!==t)return!1;return!0}(e,"string")||tG)throw Error("The upload items type is not supported");this.uploadFilesList=yield t7(e,!0)}if(!this.uploadFilesList||!this.uploadFilesList.length)throw this.uploadFilesList=null,Error("No files to upload");let t=!1;for(let e of this.uploadFilesList)if(e.isDir()||e.getRelPath().length>1){t=!0;break}return this.uploadInterrupting=!0,this.sendToServer("\x03"),yield new Promise(e=>setTimeout(e,200)),this.uploadInterrupting=!1,this.uploadSkipTrzCommand=!0,this.sendToServer(t?"trz -d\r":"trz\r"),setTimeout(()=>{this.uploadFilesList&&(this.uploadFilesList=null,this.uploadFilesResolve=null,this.uploadFilesReject&&(this.uploadFilesReject("Upload does not start"),this.uploadFilesReject=null))},this.dragInitTimeout),new Promise((e,t)=>{this.uploadFilesResolve=e,this.uploadFilesReject=t})})}uniqueIdExists(e){if(e.length<8||!this.isWindowsShell&&14==e.length&&e.endsWith("00"))return!1;if(this.uniqueIdMaps.has(e))return!0;if(this.uniqueIdMaps.size>=100){let e=new Map;for(let[t,i]of this.uniqueIdMaps)i>=50&&e.set(t,i-50);this.uniqueIdMaps=e}return this.uniqueIdMaps.set(e,this.uniqueIdMaps.size),!1}detectAndHandleTrzsz(e){return h(this,void 0,void 0,function*(){let t=yield function(e){return h(this,void 0,void 0,function*(){let t;if("string"==typeof e){let t=e.lastIndexOf(ik);return t<0?null:e.substring(t)}if(e instanceof ArrayBuffer)t=new Uint8Array(e);else if(e instanceof Uint8Array)t=e;else{if(!(e instanceof Blob))return null;t=new Uint8Array((yield e.arrayBuffer()))}if(t.length<26)return null;let i=-1,r=-1;for(;;){if((i=t.indexOf(58,i+1))<0||t.length-i<26)return r>=0?tV(t.subarray(r)):null;let e=new Float64Array(t.buffer.slice(t.byteOffset+i,t.byteOffset+i+16));e[0]==iA[0]&&e[1]==iA[1]&&(r=i,i+=25)}})}(e);if(!t)return;let i=t.match(ix);if(!i)return;let r=i.length>3?i[3]:"";if(this.uniqueIdExists(r))return;let n=i[1],s=i[2],a=!1;(":1"==r||14==r.length&&r.endsWith("10"))&&(a=!0);try{this.trzszTransfer=new ig(this.sendToServer,this.isWindowsShell),"S"===n?yield this.handleTrzszDownloadFiles(s,a):"R"===n?yield this.handleTrzszUploadFiles(s,!1,a):"D"===n&&(yield this.handleTrzszUploadFiles(s,!0,a)),this.uploadFilesResolve&&this.uploadFilesResolve()}catch(e){yield this.trzszTransfer.clientError(e),this.uploadFilesReject&&this.uploadFilesReject(e)}finally{this.uploadFilesResolve=null,this.uploadFilesReject=null,this.trzszTransfer.cleanup(),this.textProgressBar&&this.textProgressBar.showCursor(),this.textProgressBar=null,this.trzszTransfer=null}})}createProgressBar(e,t){!0!==e?(this.textProgressBar=new iv(this.writeToTerminal,this.terminalColumns,t),this.textProgressBar.hideCursor()):this.textProgressBar=null}handleTrzszDownloadFiles(e,t){return h(this,void 0,void 0,function*(){let e,i,r;if(tG){let n=yield function(){return h(this,void 0,void 0,function*(){if("function"!=typeof window.showDirectoryPicker)throw il();try{return yield window.showDirectoryPicker({id:"trzsz_download",startIn:"downloads",mode:"readwrite"})}catch(e){if("AbortError"===e.name)return;throw e}})}();if(!n)return void(yield this.trzszTransfer.sendAction(!1,t));e=n.name,i={handle:n,maps:new Map},r=i_}else{if(!(e=yield this.chooseSaveDirectory()))return void(yield this.trzszTransfer.sendAction(!1,t));yield function(e){return h(this,void 0,void 0,function*(){if(!e)return!1;if(!(yield t3.accessAsync(e)))throw new t2(`No such directory: ${e}`);if(!(yield t3.statAsync(e)).isDirectory())throw new t2(`Not a directory: ${e}`);if(!(yield t3.accessAsync(e,t3.constants.W_OK)))throw new t2(`No permission to write: ${e}`);return!0})}(e),i={path:e,maps:new Map},r=is}yield this.trzszTransfer.sendAction(!0,t);let n=yield this.trzszTransfer.recvConfig();this.createProgressBar(n.quiet,n.tmux_pane_width);let s=yield this.trzszTransfer.recvFiles(i,r,this.textProgressBar);yield this.trzszTransfer.clientExit(t6(s,e))})}handleTrzszUploadFiles(e,t,i){return h(this,void 0,void 0,function*(){let e;if(this.uploadFilesList)e=this.uploadFilesList,this.uploadFilesList=null;else if(tG)e=t?yield function(){return h(this,void 0,void 0,function*(){let e;if("function"!=typeof window.showDirectoryPicker)throw il();try{e=yield window.showDirectoryPicker({id:"trzsz_upload",startIn:"documents"})}catch(e){if("AbortError"===e.name)return;throw e}let t=[];return yield function e(t,i,r,n){var s,a,o,l;return h(this,void 0,void 0,function*(){if("file"===i.kind){let e=yield i.getFile();r.push(new ia(t,n,e,!1))}else if("directory"===i.kind){r.push(new ia(t,n,null,!0));try{for(var h,u=!0,f=d(i.values());!(s=(h=yield f.next()).done);u=!0){l=h.value,u=!1;let s=l.name;"file"===l.kind?yield e(t,(yield i.getFileHandle(s)),r,[...n,s]):"directory"===l.kind&&(yield e(t,(yield i.getDirectoryHandle(s)),r,[...n,s]))}}catch(e){a={error:e}}finally{try{!u&&!s&&(o=f.return)&&(yield o.call(f))}finally{if(a)throw a.error}}}})}(0,e,t,[e.name]),t})}():yield function(){return h(this,void 0,void 0,function*(){let e;if("function"!=typeof window.showOpenFilePicker)throw il();try{e=yield window.showOpenFilePicker({id:"trzsz_upload",startIn:"documents",multiple:!0})}catch(e){if("AbortError"===e.name)return;throw e}if(!e||!e.length)return;let t=[];for(let[i,r]of e.entries()){let e=yield r.getFile();t.push(new ia(i,[e.name],e,!1))}return t})}();else{let i=yield this.chooseSendFiles(t);e=yield t7(i,t)}if(!e||!e.length)return void(yield this.trzszTransfer.sendAction(!1,i));yield this.trzszTransfer.sendAction(!0,i);let r=yield this.trzszTransfer.recvConfig();!0===r.overwrite&&function(e){let t=new Set;for(let i of e){let e=i.getRelPath().join("/");if(t.has(e))throw new t2(`Duplicate name: ${e}`);t.add(e)}}(e),this.createProgressBar(r.quiet,r.tmux_pane_width);let n=yield this.trzszTransfer.sendFiles(e,this.textProgressBar);yield this.trzszTransfer.clientExit(t6(n,""))})}}({writeToTerminal:e=>iT.write("string"==typeof e?e:new Uint8Array(e)),sendToServer:e=>{iF&&(e instanceof Uint8Array?iF.emit("pty-input",{input:base64js.fromByteArray(e)}):iF.emit("pty-input",{input:e}))},terminalColumns:iT&&iT.cols});function iL(e){if(iE&&iT){iE.fit();let t={cols:iT.cols,rows:iT.rows};if(e?.cols&&e?.rows&&(t=e),iF)iF.emit("resize",t);else try{Edrys.sendMessage("resize",JSON.stringify(t))}catch(e){}}}const iO=iS({data:()=>({status:null,isStation:!1,connected:!1,enable:{student:!1,teacher:!1},server:iD,script:iU}),methods:{reload(){iF&&iF.close(),this.connectStation()},execute(e){let t="\x03\x03\n"+this.script;t.endsWith("\n")||(t+="\n"),Edrys.module&&Edrys.sendMessage("input_"+Edrys.role,t.replace("$CODE",btoa(iz(e))))},store(e){let t="";for(let i in e){let r=e[i];r.endsWith("\n")||(r+="\n"),t+=`echo ${btoa(iz(r))} | base64 --decode > ${iz(i)}
`}Edrys.module&&Edrys.sendMessage("input_"+Edrys.role,t)},initTerminal(){let e;(iT=new Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:!0})).attachCustomKeyEventHandler(function(e){if("keydown"!==e.type)return!0;if(e.ctrlKey&&e.shiftKey){let i=e.key.toLowerCase();if("v"===i)return navigator.clipboard.readText().then(e=>{iF?iF.emit("pty-input",{input:e}):Edrys.module&&t(e)}),!1;if("c"===i||"x"===i){let e=iT.getSelection();return navigator.clipboard.writeText(e),iT.focus(),!1}}return!0}),iE=new FitAddon.FitAddon,iT.loadAddon(iE),iT.loadAddon(new WebLinksAddon.WebLinksAddon),iT.loadAddon(new SearchAddon.SearchAddon),iT.open(iC),iE.fit(),iT.resize(12,50),iE.fit(),iT.writeln("Welcome to pyxterm.js!"),iT.writeln("https://github.com/cs01/pyxterm.js"),iT.writeln(""),iT.writeln("You can copy with ctrl+shift+x"),iT.writeln("You can paste with ctrl+shift+v"),iT.writeln("");let t=function(e,t=500){let i="",r=null;function n(){i.length>0&&(e(i),i=""),r=null}return e=>{r&&window.clearTimeout(r),null!==e&&(i+=e),r=window.setTimeout(n,t)}}(e=>{Edrys.sendMessage("input_"+Edrys.role,e)},100),i=document.createElement("input");i.type="file",i.style.display="none",document.body.appendChild(i),i.addEventListener("change",async e=>{if(e.target.files.length>0){let t=await Promise.all(Array.from(e.target.files).map(e=>new Promise((t,i)=>{let r=new FileReader;r.onload=()=>{t({name:e.name,type:e.type,content:r.result.split(",")[1]})},r.onerror=i,r.readAsDataURL(e)})));Edrys.sendMessage("upload-files",JSON.stringify(t))}}),iT.onData(e=>{if("\r"===e){if("upload"===iB.trim()&&("station"===Edrys.role||"teacher"===Edrys.role)){i.click(),iB="";return}if(iB.startsWith("download")){let e=iB.split(" ")[1];if(!e){Edrys.sendMessage("pty-output","\r\nPlease provide a filename!!\r\n"),iB="";return}iR=!0,Edrys.sendMessage("fetch-file",e),iB="";return}iB=""}else""===e||"\b"===e?iB=iB.slice(0,-1):e.match(/[\x00-\x1F]/)||(iB+=e);iF?iN.processTerminalInput(e):Edrys.module&&t(e)}),iT.onBinary(e=>{iN.processBinaryInput(e)}),iC.addEventListener("dragover",e=>e.preventDefault()),iC.addEventListener("drop",e=>{e.preventDefault(),iN.uploadFiles(e.dataTransfer.items).then(()=>{console.log("upload success")}).catch(e=>console.log(e))}),window.onresize=function(...t){let i=this;clearTimeout(e),e=setTimeout(()=>iL.apply(i,t),50)}},uploadFilesToTerminal(e){let t=JSON.parse(e),i=new DataTransfer;t.forEach(e=>{let t=atob(e.content),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let n=new File([r],e.name,{type:e.type});i.items.add(n)});let r=i.files;iN.uploadFiles(r).then(()=>{console.log("Upload successful")}).catch(e=>console.error("Upload failed:",e))},downloadFile(e){let t=JSON.parse(e),i=t.name,r=t.content;if(i){let e=new Blob([Uint8Array.from(atob(r),e=>e.charCodeAt(0))]),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=i,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t),iT.write(`\r
${i} downloaded\r
`),iN.sendToServer("\x03")}else iT.write("\r\nNo file found to download.\r\n")},connectUser(){let e=this;Edrys.onMessage(({from:t,subject:i,body:r})=>{switch(i){case"pty-output":iN.processServerOutput(r);break;case"connect":"true"===r?e.status=!0:"false"===r?e.status=!1:e.status=null,iL();break;case"download-file":iR&&(e.downloadFile(r),iR=!1);break;case"upload-files":e.uploadFilesToTerminal(r)}})},connectStation(){(iF=io.connect(this.server,{reconnectionAttempts:1/0})).on("connect_error",e=>{console.log("Connection error:",e.message)});let e=this;iF.on("pty-output",function(e){iN.processServerOutput(e.output),Edrys.module&&Edrys.sendMessage("pty-output",e.output),iI=e.output}),iF.on("fetch-file-response",e=>{let t=JSON.stringify({name:e.name,content:e.content});Edrys.module&&Edrys.sendMessage("download-file",t)}),iF.on("connect",()=>{iL(),e.status=!0,Edrys.module&&Edrys.sendMessage("connect","true"),iF.emit("pty-input",{input:"\n"})}),iF.on("disconnect",()=>{e.status=!1,Edrys.module&&Edrys.sendMessage("connect","false")}),Edrys.module&&(Edrys.onMessage(({from:t,subject:i,body:r})=>{switch(i){case"input_teacher":e.enable.teacher&&iF.emit("pty-input",{input:r});break;case"input_student":e.enable.student&&iF.emit("pty-input",{input:r});break;case"input_station":iF.emit("pty-input",{input:r});break;case"join":Edrys.sendMessage("connect",JSON.stringify(e.status)),Edrys.sendMessage("pty-output",iI);break;case"resize":iL(JSON.parse(r));break;case"download-file":iR&&(e.downloadFile(r),console.log("File downloaded"),iR=!1);break;case"upload-files":e.uploadFilesToTerminal(r);break;case"fetch-file":iF.emit("fetch-file",r)}}),Edrys.onMessage(({from:t,subject:i,body:r,module:n})=>{if(i===(Edrys.module.stationConfig?.execute||"execute")){try{let t=JSON.parse(r);if(t.file){e.store(t.file),e.execute("");return}}catch(e){console.warn("Error, could not execute command:",e.message)}e.execute(r)}},promiscuous=!0))}}}).mount("#app");iO.initTerminal(),Edrys.onReady(()=>{console.log("Module is loaded!"),"station"===Edrys.role?(iO.isStation=!0,iO.server=Edrys.module.stationConfig?.server||iD,iO.script=Edrys.module.stationConfig?.script||iU,iO.enable.student=Edrys.module.stationConfig?.enable?.student||!1,iO.enable.teacher=Edrys.module.stationConfig?.enable?.teacher||!1,iO.connectStation()):iO.connectUser(),Edrys.sendMessage("join",null)}),setTimeout(function(){Edrys.module||(console.warn("connect"),iO.connectStation())},5e3);</script> </body></html>